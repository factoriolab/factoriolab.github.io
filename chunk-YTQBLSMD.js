import{Nb as d,Nd as y,O as m,Qb as f,Qc as r,S as h,e as p,ld as a,pd as u,sd as g,td as b}from"./chunk-YDUZY7N5.js";var E="lab-icon-css",S="lab-theme-css",P=(()=>{class l{constructor(){this.document=h(f),this.preferencesSvc=h(b),this.settingsSvc=h(y),this.themeValues$=new p(1),this.head=this.document.getElementsByTagName("head")[0],d(()=>{let e=this.preferencesSvc.theme(),c=this.document.getElementById(S);if(c){let s=this.themePath(e);if(c.href.endsWith(s))this.updateThemeValues();else{let i=this.document.createElement("link");i.rel="stylesheet",i.href=s,i.onload=()=>{c.href=s,this.head.removeChild(i),this.updateThemeValues()},this.head.appendChild(i)}}for(let s of[a.Light,a.Dark,a.Black])s===e?this.document.body.classList.add(s):this.document.body.classList.remove(s)}),d(()=>{let e=this.settingsSvc.dataset(),c=this.document.getElementById(E);c&&this.head.removeChild(c);let s=this.document.createElement("style");s.id=E;let i="";e.iconIds.forEach(t=>{let o=e.iconEntities[t],n=this.escapeSelector(t);i+=`.${n}::before { background-image: url("${e.iconFile}"); background-position: ${o.position}; } `,i+=this.appendLightStyle(o,n,"")}),e.itemIds.map(t=>e.itemEntities[t]).filter(r("icon")).filter(t=>!e.itemQIds.has(t.id)).forEach(t=>{let o=e.iconEntities[t.icon],n=this.escapeSelector(t.id);i+=`.${n}.item::before { background-image: url("${e.iconFile}"); background-position: ${o.position}; } `,i+=this.appendLightStyle(o,n,".item")}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(r("icon")).filter(t=>!e.recipeQIds.has(t.id)).forEach(t=>{let o=e.iconEntities[t.icon],n=this.escapeSelector(t.id);i+=`.${n}.recipe::before { background-image: url("${e.iconFile}"); background-position: ${o.position}; } `,i+=this.appendLightStyle(o,n,".recipe")}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(r("icon")).forEach(t=>{let o=e.iconEntities[t.icon],n=this.escapeSelector(t.id);i+=`.${n}.category::before { background-image: url("${e.iconFile}"); background-position: ${o.position}; } `,i+=this.appendLightStyle(o,n,".category")}),e.locationIds.map(t=>e.locationEntities[t]).filter(r("icon")).forEach(t=>{let o=e.iconEntities[t.icon],n=this.escapeSelector(t.id);i+=`.${n}.location::before { background-image: url("${e.iconFile}"); background-position: ${o.position}; } `,i+=this.appendLightStyle(o,n,".location")}),e.itemIds.map(t=>e.itemEntities[t]).filter(r("iconText")).filter(t=>!e.itemQIds.has(t.id)).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.item::before { content: "${t.iconText}"; } `}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(r("iconText")).filter(t=>!e.recipeQIds.has(t.id)).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.recipe::before { content: "${t.iconText}"; } `}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(r("iconText")).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.category::before { content: "${t.iconText}"; } `}),e.locationIds.map(t=>e.locationEntities[t]).filter(r("iconText")).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.location::before { content: "${t.iconText}"; } `}),s.innerText=i,this.head.appendChild(s)})}appendLightStyle(e,c,s){if(!e.invertLight)return"";let i=`body.light .${c}${s}::before { filter: invert(1); } `;return i+=`.invert .${c}::before { filter: invert(1); } `,i+=`body.light .invert .${c}::before { filter: none; } `}updateThemeValues(){let e=getComputedStyle(this.document.body),c={textColor:e.getPropertyValue("--text-color"),successColor:e.getPropertyValue("--success-color"),successBackground:e.getPropertyValue("--success-background"),dangerColor:e.getPropertyValue("--danger-color"),dangerBackground:e.getPropertyValue("--danger-background")};this.themeValues$.next(c)}themePath(e){switch(e){case a.Light:return"theme-light.css";case a.Black:return"theme-black.css";default:return"theme-dark.css"}}escapeSelector(e){return e.replace(/([^A-Za-z0-9_-])/g,"\\$1")}static appInitTheme(){let e=g.theme,c=u("preferences");if(c)try{e=JSON.parse(c).theme}catch{}if(e===a.Light){let s=window.document.getElementById(S);s&&(s.href="theme-light.css")}}static{this.\u0275fac=function(c){return new(c||l)}}static{this.\u0275prov=m({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();export{P as a};
