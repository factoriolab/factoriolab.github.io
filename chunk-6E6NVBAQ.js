import{a as Ue,b as ze,c as qe,d as Je,f as Ze,g as tn}from"./chunk-K6EN3XAA.js";import{a as De}from"./chunk-3RG4TA4A.js";import{b as Mt}from"./chunk-XEZ65W3E.js";import{a as $t,b as He,c as Ne,d as Ae,e as We,f as Lt}from"./chunk-GAFADBS6.js";import{a as Rt,b as jt}from"./chunk-NXW5L5BB.js";import{a as Ee,b as ke}from"./chunk-CAIGWISA.js";import{b as Fe,f as Re,g as je,t as $e}from"./chunk-3KP23RO2.js";import{a as Ke,b as Xe}from"./chunk-7BJO47CB.js";import{b as At,c as Ge,d as Qe,e as Ye,g as Wt}from"./chunk-PZSAH6BK.js";import{a as Ht,b as Nt}from"./chunk-6BGK3QDP.js";import{a as Le,b as Dt}from"./chunk-GLT366G4.js";import{f as Ft,g as Pt}from"./chunk-NPSC7M4P.js";import{e as dt,f as mt,h as ut}from"./chunk-LTEWF33W.js";import{a as Ot,b as Vt}from"./chunk-QT5YN6FI.js";import{f as _t,g as st}from"./chunk-BZRSHDAE.js";import{n as pt,t as ct}from"./chunk-RSGFXRWW.js";import{a as Bt,b as Pe,c as rt}from"./chunk-LSWT43E5.js";import{$ as k,Ab as x,Ba as c,Bb as w,Cb as gt,Cd as Ve,D as ae,Db as M,E as le,Ea as u,Ga as ft,Ha as re,Hc as I,Ia as O,Ib as xe,Ja as r,Jc as v,Ka as Tt,Lb as ge,Ld as kt,Ma as H,Na as N,Nb as Xt,Nc as Z,Nd as X,O as pe,Oa as _,Pa as s,Qa as f,Qb as Se,Qc as yt,S as P,Sc as Be,T as et,Ta as R,Ua as F,Uc as K,Va as B,W as L,Wa as a,Wc as tt,Yb as ve,Zb as he,_ as E,_b as be,ba as bt,bb as de,cb as me,d as ne,db as h,eb as S,fb as T,gb as j,ha as _e,hc as Ie,hd as Gt,ia as Jt,ib as nt,ic as Te,jb as it,kb as ot,lb as ue,lc as ye,m as ie,ma as se,mb as Ce,nb as fe,nd as Qt,oc as we,od as Me,pb as at,qa as p,qb as Y,qd as Oe,sb as J,sd as wt,tb as xt,td as Et,v as oe,wd as W,xa as Kt,ya as ce,yb as lt,yd as St,za as It,zb as d}from"./chunk-FWXHGAVU.js";import{f as Sn,h as vn,j as ee}from"./chunk-TWZW5B45.js";var en=Sn((Yt,Zt)=>{"use strict";(function(t,o){typeof define=="function"&&define.amd?define([],o):typeof Yt<"u"?o():(o(),t.FileSaver={})})(Yt,function(){"use strict";function t(C,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(C.type)?new Blob(["\uFEFF",C],{type:C.type}):C}function o(C,g,y){var b=new XMLHttpRequest;b.open("GET",C),b.responseType="blob",b.onload=function(){m(b.response,g,y)},b.onerror=function(){console.error("could not download file")},b.send()}function e(C){var g=new XMLHttpRequest;g.open("HEAD",C,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function n(C){try{C.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),C.dispatchEvent(g)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(C,g,y){var b=i.URL||i.webkitURL,V=document.createElement("a");g=g||C.name||"download",V.download=g,V.rel="noopener",typeof C=="string"?(V.href=C,V.origin===location.origin?n(V):e(V.href)?o(C,g,y):n(V,V.target="_blank")):(V.href=b.createObjectURL(C),setTimeout(function(){b.revokeObjectURL(V.href)},4e4),setTimeout(function(){n(V)},0))}:"msSaveOrOpenBlob"in navigator?function(C,g,y){if(g=g||C.name||"download",typeof C!="string")navigator.msSaveOrOpenBlob(t(C,y),g);else if(e(C))o(C,g,y);else{var b=document.createElement("a");b.href=C,b.target="_blank",setTimeout(function(){n(b)})}}:function(C,g,y,b){if(b=b||open("","_blank"),b&&(b.document.title=b.document.body.innerText="downloading..."),typeof C=="string")return o(C,g,y);var V=C.type==="application/octet-stream",$=/constructor/i.test(i.HTMLElement)||i.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||V&&$||l)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var Q=A.result;Q=D?Q:Q.replace(/^data:[^;]*;/,"data:attachment/file;"),b?b.location.href=Q:location=Q,b=null},A.readAsDataURL(C)}else{var G=i.URL||i.webkitURL,Ct=G.createObjectURL(C);b?b.location=Ct:location.href=Ct,b=null,setTimeout(function(){G.revokeObjectURL(Ct)},4e4)}});i.saveAs=m.saveAs=m,typeof Zt<"u"&&(Zt.exports=m)})});var te=vn(en());var hn="text/csv;charset=UTF-8",bn=".csv",In="text/json;charset=UTF-8",Tn=".json",yn=["Item","Items","Surplus","Inputs","Outputs","Targets","Belts","Belt","Wagons","Wagon","Recipe","Machines","Machine","Modules","Beacons","Power","Pollution"],nn=(()=>{class t{constructor(){this.itemsSvc=P(Bt),this.recipeSvc=P(kt),this.recipesSvc=P(rt),this.settingsSvc=P(X),this.itemsState=this.itemsSvc.settings,this.recipesState=this.recipesSvc.settings,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset}stepsToCsv(e){let n=e.map(m=>this.stepToJson(m,e)),i=yn.filter(m=>n.some(C=>C[m]!=null)),l=n.map(m=>i.map(C=>m[C]).join(","));l.unshift(i.join(",")),l.unshift(`"${window.location.href}"`),this.saveAsCsv(l.join(`\r
`),"factoriolab_list")}flowToJson(e){this.saveAsJson(JSON.stringify(e),"factoriolab_flow")}saveAsCsv(e,n){(0,te.saveAs)(new Blob([e],{type:hn}),n+bn)}saveAsJson(e,n){(0,te.saveAs)(new Blob([e],{type:In}),n+Tn)}stepToJson(e,n){let i=this.columnsState(),l=this.itemsState(),m=this.recipesState(),C=this.data(),g={};if(e.itemId!=null){g.Item=e.itemId;let y=l[e.itemId];e.items!=null&&(g.Items="="+e.items.sub(e.surplus??v.zero).toString()),e.surplus!=null&&(g.Surplus="="+e.surplus.toString()),i.belts.show&&(e.belts!=null&&(g.Belts="="+e.belts.toString()),g.Belt=y.beltId),i.wagons.show&&(e.wagons!=null&&(g.Wagons="="+e.wagons.toString()),g.Wagon=y.wagonId)}if(e.recipeId!=null){g.Recipe=e.recipeId;let y=C.adjustedRecipe[e.recipeId],b=m[e.recipeId],V=Object.keys(y.in).map($=>{let D=n.find(A=>A.itemId===$);return[$,D?.parents?.[e.id]?.toString()??""]}).filter($=>$[1]).map($=>`${$[0]}:${$[1]}`).join(",");if(V&&(g.Inputs=`"${V}"`),b.machineId!=null){let $=C.machineEntities[b.machineId],D=this.recipeSvc.allowsModules(y,$);i.machines.show&&(e.machines!=null&&(g.Machines="="+e.machines.toString()),g.Machine=b.machineId,D&&b.modules!=null&&(g.Modules=`"${b.modules.filter(yt("count","id")).map(A=>`${A.count.toString()} ${A.id}`).join(",")}"`)),i.beacons.show&&D&&(g.Beacons=`"${Z(b.beacons?.map(A=>`${Z(A.count?.toString(),"")} ${Z(A.id,"")} (${Z(A.modules?.filter(yt("count","id")).map(G=>`${G.count.toString()} ${G.id}`).join(","),"")})`).join(","),"")}"`),i.power.show&&e.power!=null&&(g.Power="="+e.power.toString()),i.pollution.show&&e.pollution!=null&&(g.Pollution="="+e.pollution.toString())}}if(e.outputs!=null){let y=e.outputs,b=Object.keys(y).map(V=>`${V}:${y[V].toString()}`).join(",");g.Outputs=`"${b}"`}if(e.parents!=null){let y=e.parents,b=Object.keys(y).map(V=>n.find($=>$.id===V)).filter(Be).filter(yt("recipeId")).map(V=>`${V.recipeId}:${y[V.id].toString()}`).join(",");g.Targets=`"${b}"`}return g}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=pe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var on=(()=>{class t{transform(e){return e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"asStep",type:t,pure:!0,standalone:!0})}}return t})();var an={[St.Chest]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.BulkInserter,value:v(4.62)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.67)},{id:I.LongHandedInserter,value:v(2.4)},{id:I.FastInserter,value:v(4.62)},{id:I.BulkInserter,value:v(9.23)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.5)},{id:I.LongHandedInserter,value:v(3.6)},{id:I.FastInserter,value:v(6.92)},{id:I.BulkInserter,value:v(27.69)}]},[St.ExpressTransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.BulkInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.BulkInserter,value:v(7.74)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.43)},{id:I.LongHandedInserter,value:v(3.46)},{id:I.FastInserter,value:v(6.43)},{id:I.BulkInserter,value:v(13.85)}]},[St.FastTransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.BulkInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.BulkInserter,value:v(7.06)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.37)},{id:I.LongHandedInserter,value:v(3.33)},{id:I.FastInserter,value:v(6)},{id:I.BulkInserter,value:v(10.91)}]},[St.TransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.BulkInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.BulkInserter,value:v(5.71)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.25)},{id:I.LongHandedInserter,value:v(3.1)},{id:I.FastInserter,value:v(5.29)},{id:I.BulkInserter,value:v(6.79)}]}};var ln=(()=>{class t{transform(e,n){if(e!=null){let i=an[n.inserterTarget][n.inserterCapacity]?.find(l=>l.value.gt(e)||l.id===I.BulkInserter);return i==null?null:{id:i.id,value:e.div(i.value)}}return null}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"inserterSpeed",type:t,pure:!0,standalone:!0})}}return t})();var pn=(()=>{class t{transform(e){return e==null?"":" ".repeat(4-e.length)+e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"leftPad",type:t,pure:!0,standalone:!0})}}return t})();var z=(()=>{class t{static transform(e,n){if(n==null)return e.toFraction();if(n===-2)return Math.round(e.mul(v(100n)).toNumber()).toString();let l=e.toPrecision(n).toString();if(n>0){let m=v(1,Math.pow(10,n));e.gt(v.zero)&&e.lt(m)&&(l=`<${l}`);let C=l.split(".");if(C.length>1){if(C[1].length<n){let g=n-C[1].length;return l+"0".repeat(g)}}else return e.isInteger()?l+" ".repeat(n+1):l+"."+"0".repeat(n)}return l}transform(e,n){return t.transform(e,n)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"rate",type:t,pure:!0,standalone:!0})}}return t})();var _n=(()=>{class t{transform(e,n,i){return i===I.Pumpjack?`${z.transform(e.mul(v(100n)),n!=null?Math.max(n-2,0):n)}%`:z.transform(e,n)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"machineRate",type:t,pure:!0,standalone:!0})}}return t})();var sn=(()=>{class t{transform(e,n,i){switch(i){case Gt.GW:return`${z.transform(e.div(v(1000000n)),n)} GW`;case Gt.MW:return`${z.transform(e.div(v(1000n)),n)} MW`;default:return`${z.transform(e,n)} kW`}}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"power",type:t,pure:!0,standalone:!0})}}return t})();var cn=(()=>{class t{constructor(){this.recipesSvc=P(rt),this.routerSvc=P(Mt),this.data=this.recipesSvc.adjustedDataset}transform(e,n){return ee(this,null,function*(){let i=e;if(i.recipeId){let l=this.data().adjustedRecipe[i.recipeId];l?.flags.has("technology")&&e.items&&(i=K(e,{items:e.items.div(l.effects.productivity)}))}return this.routerSvc.stepHref(i,n,this.data().hash)})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"stepHref",type:t,pure:!0,standalone:!0})}}return t})();var vt=(()=>{class t{static transform(e){return e.itemId??e.recipeObjectiveId??e.recipeId??e.id}transform(e){return t.transform(e)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=L({name:"stepId",type:t,pure:!0,standalone:!0})}}return t})();function kn(t,o){if(t&1&&(_(0,"div",13),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=o.$implicit;p(),O(x(2,2,e.value))}}function Bn(t,o){if(t&1&&f(0,"lab-tooltip",16),t&2){let e=a().$implicit;u("id",e.value)}}function Mn(t,o){if(t&1&&(_(0,"div",14),f(1,"i"),d(2,"iconSmClass"),_(3,"div",15),S(4),s(),c(5,Bn,1,1,"ng-template",null,0,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function On(t,o){if(t&1&&f(0,"lab-tooltip",16),t&2){let e=a();u("id",e)}}function Vn(t,o){if(t&1){let e=F();_(0,"p-dropdown",10),B("onChange",function(i){E(e);let l=a(2);return k(l.setBelt(i.value))}),c(1,kn,3,4,"ng-template",11)(2,Mn,7,6,"ng-template",12)(3,On,1,1,"ng-template",null,0,M),s()}if(t&2){let e=h(4),n=a(2);u("pTooltip",e)("ngModel",o)("options",n.options().belts)}}function Fn(t,o){if(t&1){let e=F();_(0,"lab-input-number",8),d(1,"translate"),B("setValue",function(i){E(e);let l=a();return k(l.setStack(i))}),s(),c(2,Vn,5,3,"p-dropdown",9)}if(t&2){let e,n,i=o,l=a();u("pTooltip",x(1,5,"beltOverlay.stackTooltip"))("value",(e=i==null?null:i.stack)!==null&&e!==void 0?e:l.rational.one)("minimum",l.rational.one)("maximum",l.maximum()),p(2),r((n=i.beltId)?2:-1,n)}}var un=(()=>{class t extends We{constructor(){super(...arguments),this.settingsSvc=P(X),this.setValue=_e(),this.maximum=Kt(v.zero),this.settings=Kt(void 0),this.options=this.settingsSvc.options,this.rational=v}show(e,n,i){this.settings.set(K(i)),this.maximum.set(n),this._show(e)}setStack(e){this.settings.update(n=>K(n,{stack:e}))}setBelt(e){this.settings.update(n=>K(n,{beltId:e}))}save(){let e=this.settings();e!=null&&this.setValue.emit(e)}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=bt(t)))(i||t)}})()}static{this.\u0275cmp=et({type:t,selectors:[["lab-belt-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[It,at],decls:10,vars:7,consts:[["tooltip",""],["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","flex-column"],[1,"p-inputgroup"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],["width","3rem","tooltipPosition","top",3,"setValue","pTooltip","value","minimum","maximum"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","belt",3,"id"]],template:function(n,i){if(n&1&&(_(0,"p-overlayPanel",1),B("onHide",function(){return i.onHide()}),_(1,"div",2)(2,"div",3)(3,"div",4),c(4,Fn,3,7),s()(),_(5,"div",5)(6,"button",6),d(7,"translate"),B("click",function(){return i.hide()}),s(),_(8,"button",7),d(9,"translate"),B("click",function(){return i.hide(!0)}),s()()()()),n&2){let l;p(4),r((l=i.settings())?4:-1,l),p(2),u("label",x(7,3,"ok")),p(2),u("label",x(9,5,"cancel"))}},dependencies:[ut,dt,mt,st,_t,pt,Pt,Ft,Ne,He,Vt,Ot,$t,Dt,De,Lt,ct],encapsulation:2,changeDetection:0})}}return t})();var Ut=class t{static{this.value=v(1n,3n)}transform(o){return o==null?t.value.toFraction():t.value.toPrecision(o).toString()}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275pipe=L({name:"precisionExample",type:t,pure:!0,standalone:!0})}};var $n=()=>({width:"400px"}),Dn=()=>({"400px":"100vw"});function Ln(t,o){t&1&&(_(0,"tr")(1,"th"),S(2),d(3,"translate"),s(),_(4,"th"),S(5),d(6,"translate"),s(),_(7,"th"),S(8),d(9,"translate"),s(),_(10,"th"),S(11),d(12,"translate"),s()()),t&2&&(p(2),T(x(3,4,"columns.visibility")),p(3),T(x(6,6,"columns.decimals")),p(3),T(x(9,8,"columns.fractions")),p(3),T(x(12,10,"columns.example")))}function Hn(t,o){if(t&1){let e=F();_(0,"td")(1,"p-inputNumber",7),ot("ngModelChange",function(i){E(e);let l=a().$implicit,m=a();return it(m.editValue[l.value].precision,i)||(m.editValue[l.value].precision=i),k(i)}),s()(),_(2,"td",8)(3,"p-checkbox",9),B("onChange",function(i){E(e);let l=a().$implicit,m=a();return k(m.changeFraction(i.checked,l.value))}),s()(),_(4,"td"),S(5),d(6,"precisionExample"),s()}if(t&2){let e=a().$implicit,n=a();p(),u("min",0)("size",1)("showButtons",!0)("disabled",!n.editValue[e.value].show),nt("ngModel",n.editValue[e.value].precision),p(2),u("ngModel",n.editValue[e.value].precision==null)("binary",!0)("disabled",!n.editValue[e.value].show),p(2),j(" ",x(6,9,n.editValue[e.value].precision)," ")}}function Nn(t,o){t&1&&(_(0,"td",6)(1,"div",10),S(2),d(3,"translate"),s()()),t&2&&(p(2),T(x(3,1,"columns.notApplicable")))}function An(t,o){if(t&1){let e=F();_(0,"tr")(1,"td")(2,"p-checkbox",5),d(3,"translate"),ot("ngModelChange",function(i){let l=E(e).$implicit,m=a();return it(m.editValue[l.value].show,i)||(m.editValue[l.value].show=i),k(i)}),s()(),c(4,Hn,7,11)(5,Nn,4,3,"td",6),s()}if(t&2){let e=o.$implicit,n=a();p(2),nt("ngModel",n.editValue[e.value].show),u("binary",!0)("label",x(3,5,e.label))("disabled",e.disabled),p(2),r(n.columnsInf[e.value].hasPrecision?4:5)}}function Wn(t,o){if(t&1){let e=F();_(0,"button",14),d(1,"translate"),B("click",function(){E(e);let i=a(2);return k(i.reset())}),s()}t&2&&u("label",x(1,1,"reset"))}function Un(t,o){if(t&1){let e=F();c(0,Wn,2,3,"button",11),_(1,"button",12),d(2,"translate"),B("click",function(){E(e);let i=a();return k(i.hide())}),s(),_(3,"button",13),d(4,"translate"),B("click",function(){E(e);let i=a();return k(i.hide(!0))}),s()}if(t&2){let e=a();r(e.modified?0:-1),p(),u("label",x(2,3,"ok")),p(2),u("label",x(4,5,"cancel"))}}var Cn=(()=>{class t extends Ae{constructor(){super(...arguments),this.preferencesSvc=P(Et),this.settingsSvc=P(X),this.columnOptions=this.settingsSvc.columnOptions,this.editValue=Me,this.columnsInf=Qt}get modified(){return Object.keys(this.editValue).some(e=>this.editValue[e].precision!==wt.columns[e].precision||this.editValue[e].show!==wt.columns[e].show)}initEdit(e){this.editValue=Object.keys(e).filter(n=>Qt[n]!=null).reduce((n,i)=>(n[i]=K(e[i]),n),{})}open(e){this.initEdit(e),this.show()}changeFraction(e,n){this.editValue[n].precision=e?null:1}reset(){this.initEdit(wt.columns)}save(){let e=this.editValue;this.preferencesSvc.apply({columns:e})}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=bt(t)))(i||t)}})()}static{this.\u0275cmp=et({type:t,selectors:[["lab-columns"]],standalone:!0,features:[It,at],decls:6,vars:15,consts:[["appendTo","body",3,"visibleChange","onHide","visible","modal","dismissableMask","draggable","resizable","focusOnShow","breakpoints","header"],["responsiveLayout","scroll","styleClass","p-datatable-sm",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"ngModelChange","ngModel","binary","label","disabled"],["colspan","3",1,"text-center"],["styleClass","w-100","inputStyleClass","text-end",1,"w-100",3,"ngModelChange","min","size","showButtons","disabled","ngModel"],[1,"text-center"],[3,"onChange","ngModel","binary","disabled"],[1,"p-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-secondary",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"click","label"]],template:function(n,i){n&1&&(_(0,"p-dialog",0),d(1,"translate"),ot("visibleChange",function(m){return it(i.visible,m)||(i.visible=m),m}),B("onHide",function(){return i.onHide()}),_(2,"p-table",1),c(3,Ln,13,12,"ng-template",2)(4,An,6,7,"ng-template",3),s(),c(5,Un,5,7,"ng-template",4),s()),n&2&&(re(Y(13,$n)),nt("visible",i.visible),u("modal",!0)("dismissableMask",!0)("draggable",!1)("resizable",!1)("focusOnShow",!1)("breakpoints",Y(14,Dn))("header",x(1,11,"columns.header")),p(2),u("value",i.columnOptions()))},dependencies:[ut,dt,mt,st,_t,pt,jt,Rt,ke,Ee,Nt,Ht,Wt,At,Ut,ct],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:115px}[_nghost-%COMP%]     .p-dialog-content{padding-bottom:1rem}"],changeDetection:0})}}return t})();var zn=["stepsTable"],zt=(t,o)=>o.id,q=(t,o)=>o.key,qn=()=>[25,50,100,1e3],fn=()=>[],Jn=(t,o,e,n,i,l,m,C,g,y,b,V,$,D)=>({items:t,itemId:o,belts:e,beltId:n,stack:i,wagons:l,wagonId:m,machines:C,machineId:g,recipeId:y,recipeObjectiveId:b,percent:V,percentOnDest:!0,destId:$,inputs:D}),Kn=(t,o,e,n,i,l,m,C,g,y,b,V,$,D,A)=>({items:t,itemId:o,belts:e,beltId:n,stack:i,wagons:l,wagonId:m,machines:C,machineId:g,recipeId:y,recipeObjectiveId:b,percent:V,destId:$,destRecipeObjectiveId:D,destIsRecipe:!0,outputs:A}),Xn=(t,o)=>({items:t,itemId:o}),Gn=(t,o,e,n,i,l,m,C,g,y,b,V,$,D)=>({items:t,itemId:o,belts:e,beltId:n,stack:i,wagons:l,wagonId:m,machines:C,machineId:g,recipeId:y,recipeObjectiveId:b,percent:V,destId:$,destRecipeObjectiveId:D,destIsRecipe:!0}),Qn=(t,o,e,n,i,l,m,C,g,y)=>({items:t,itemId:o,belts:e,beltId:n,stack:i,wagons:l,wagonId:m,percent:C,destId:g,destRecipeObjectiveId:y,destIsRecipe:!0}),Yn=(t,o,e,n,i,l,m,C,g,y,b,V,$,D)=>({items:t,itemId:o,belts:e,beltId:n,stack:i,wagons:l,wagonId:m,machines:C,machineId:g,recipeId:y,recipeObjectiveId:b,percent:V,percentOnDest:!0,destId:$,destRecipeObjectiveId:D}),qt=(t,o)=>({value:t,itemId:o}),xn=(t,o,e)=>({value:t,itemId:o,stack:e}),Zn=(t,o)=>({columnSettings:t,totals:o,type:"belt"}),ti=(t,o)=>({columnSettings:t,totals:o}),ei=(t,o,e)=>({columnSettings:t,totals:o,modulesTotals:e,type:"machine"}),ni=(t,o,e)=>({columnSettings:t,totals:o,modulesTotals:e,type:"beacon"});function ii(t,o){if(t&1){let e=F();_(0,"button",39),d(1,"translate"),B("click",function(){E(e);let i=a(2);return k(i.exportSvc.stepsToCsv(i.steps()))}),s()}t&2&&u("label",x(1,1,"steps.downloadAsCsv"))}function oi(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(){E(e);let i=a(3);return k(i.resetChecked())}),s()}t&2&&u("pTooltip",x(1,1,"steps.checkedUndoTooltip"))}function ai(t,o){if(t&1&&(_(0,"th")(1,"div",40),f(2,"i",41),c(3,oi,2,3,"button",30),s()()),t&2){let e=a(2);p(3),r(e.settings().checkedItemIds.size||e.settings().checkedRecipeIds.size||e.settings().checkedObjectiveIds.size?3:-1)}}function li(t,o){t&1&&(_(0,"th"),S(1),d(2,"translate"),s()),t&2&&(p(),T(x(2,1,"options.column.tree")))}function pi(t,o){t&1&&f(0,"p-sortIcon",29)}function _i(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(i){E(e);let l=a(2);return k(l.resetExcludedItems(i))}),s()}t&2&&u("pTooltip",x(1,1,"steps.itemsUndoTooltip"))}function si(t,o){t&1&&f(0,"p-sortIcon",43)}function ci(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(i){E(e);let l=a(3);return k(l.resetBelts(i))}),s()}t&2&&u("pTooltip",x(1,1,"steps.beltsUndoTooltip"))}function ri(t,o){if(t&1&&(_(0,"th",31)(1,"div",28)(2,"span"),S(3),d(4,"translate"),s(),c(5,si,1,0,"p-sortIcon",43)(6,ci,2,3,"button",30),s()()),t&2){let e=a(2);p(3),T(x(4,3,"options.column.belts")),p(2),r(e.focus()?-1:5),p(),r(e.itemsModified().belts?6:-1)}}function di(t,o){t&1&&f(0,"p-sortIcon",44)}function mi(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(i){E(e);let l=a(3);return k(l.resetWagons(i))}),s()}t&2&&u("pTooltip",x(1,1,"steps.wagonsUndoTooltip"))}function ui(t,o){if(t&1&&(_(0,"th",32)(1,"div",28)(2,"span"),S(3),d(4,"translate"),s(),c(5,di,1,0,"p-sortIcon",44)(6,mi,2,3,"button",30),s()()),t&2){let e=a(2);p(3),T(x(4,3,e.dispRateInfo().wagonsLabel)),p(2),r(e.focus()?-1:5),p(),r(e.itemsModified().wagons?6:-1)}}function Ci(t,o){t&1&&f(0,"p-sortIcon",45)}function fi(t,o){if(t&1&&(_(0,"th",33)(1,"div",28)(2,"span"),S(3),d(4,"translate"),s(),c(5,Ci,1,0,"p-sortIcon",45),s()()),t&2){let e=a(2);p(3),T(x(4,2,e.dispRateInfo().rocketsLabel)),p(2),r(e.focus()?-1:5)}}function xi(t,o){t&1&&f(0,"p-sortIcon",35)}function gi(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(i){E(e);let l=a(2);return k(l.resetMachines(i))}),s()}t&2&&u("pTooltip",x(1,1,"steps.machinesUndoTooltip"))}function Si(t,o){if(t&1){let e=F();_(0,"button",42),d(1,"translate"),B("click",function(){E(e);let i=a(3);return k(i.resetBeacons())}),s()}t&2&&u("pTooltip",x(1,1,"steps.beaconsUndoTooltip"))}function vi(t,o){if(t&1&&(_(0,"th",36)(1,"div",28)(2,"span"),S(3),d(4,"translate"),s(),c(5,Si,2,3,"button",30),s()()),t&2){let e=a(2);p(3),T(x(4,2,"options.column.beacons")),p(2),r(e.recipesModified().beacons?5:-1)}}function hi(t,o){t&1&&f(0,"p-sortIcon",47)}function bi(t,o){if(t&1&&(_(0,"th",37)(1,"div",46)(2,"span"),S(3),d(4,"translate"),s(),c(5,hi,1,0,"p-sortIcon",47),s()()),t&2){let e=a(2);p(3),T(x(4,2,"options.column.power")),p(2),r(e.focus()?-1:5)}}function Ii(t,o){t&1&&f(0,"p-sortIcon",48)}function Ti(t,o){if(t&1&&(_(0,"th",38)(1,"div",46)(2,"span"),S(3),d(4,"translate"),s(),c(5,Ii,1,0,"p-sortIcon",48),s()()),t&2){let e=a(2);p(3),T(x(4,2,e.dispRateInfo().pollutionLabel)),p(2),r(e.focus()?-1:5)}}function yi(t,o){t&1&&f(0,"th")}function wi(t,o){if(t&1){let e=F();_(0,"tr")(1,"td",22)(2,"div",23)(3,"button",24),d(4,"translate"),B("click",function(){E(e);let i=a(),l=h(14);return k(l.open(i.columnsState()))}),s(),c(5,ii,2,3,"button",25),s()()(),_(6,"tr",26),f(7,"th"),c(8,ai,4,1,"th")(9,li,3,3,"th"),_(10,"th",27)(11,"div",28)(12,"span"),S(13),d(14,"translate"),s(),c(15,pi,1,0,"p-sortIcon",29)(16,_i,2,3,"button",30),s()(),c(17,ri,7,5,"th",31)(18,ui,7,5,"th",32)(19,fi,6,4,"th",33),_(20,"th",34)(21,"div",28)(22,"span"),S(23),d(24,"translate"),s(),c(25,xi,1,0,"p-sortIcon",35)(26,gi,2,3,"button",30),s()(),c(27,vi,6,4,"th",36)(28,bi,6,4,"th",37)(29,Ti,6,4,"th",38)(30,yi,1,0,"th"),s()}if(t&2){let e=a();p(3),u("label",x(4,17,"steps.columnSettings")),p(2),r(e.steps().length?5:-1),p(3),r(!e.focus()&&e.columnsState().checkbox.show?8:-1),p(),r(!e.focus()&&e.columnsState().tree.show?9:-1),p(4),T(x(14,19,e.dispRateInfo().itemsLabel)),p(2),r(e.focus()?-1:15),p(),r(e.settings().excludedItemIds.size?16:-1),p(),r(e.columnsState().belts.show?17:-1),p(),r(e.columnsState().wagons.show?18:-1),p(),r(e.columnsState().rockets.show?19:-1),p(4),T(x(24,21,"options.column.machines")),p(2),r(e.focus()?-1:25),p(),r(e.recipesModified().machines?26:-1),p(),r(e.columnsState().beacons.show?27:-1),p(),r(e.columnsState().power.show?28:-1),p(),r(e.columnsState().pollution.show?29:-1),p(),r(e.columnsState().link.show?30:-1)}}function Ei(t,o){if(t&1&&f(0,"div",50),t&2){let e=o.$implicit,n=a();u("id","step_"+n.id+"_"+e.label)}}function ki(t,o){if(t&1){let e=F();_(0,"td",53)(1,"div",58)(2,"p-checkbox",59),B("onChange",function(i){E(e);let l=a(),m=a(2);return k(m.changeStepChecked(l,i.checked))}),s()()()}if(t&2){let e=a();p(2),u("binary",!0)("ngModel",e.checked)}}function Bi(t,o){if(t&1&&f(0,"div",66),t&2){let e=o.$implicit,n=o.$index,i=o.$count;ft("trail",e)("last",n===i-1)}}function Mi(t,o){if(t&1&&(H(0,Bi,1,4,"div",65,Tt),f(2,"div",61)),t&2){let e=a(2),n=a(2);N(n.stepTree()[e.id])}}function Oi(t,o){if(t&1&&f(0,"lab-tooltip",69),t&2){let e=a(3);u("id",e.itemId)}}function Vi(t,o){if(t&1){let e=F();_(0,"button",67),d(1,"iconSmClass"),B("click",function(){E(e);let i=a(2),l=a(2);return k(l.changeItemExcluded(i.itemId,!l.settings().excludedItemIds.has(i.itemId)))}),f(2,"i",68),c(3,Oi,1,1,"ng-template",null,6,M),s()}if(t&2){let e=h(4),n=a(2),i=a(2);ft("hover-active",i.settings().excludedItemIds.has(n.itemId)),u("icon",x(1,4,n.itemId))("pTooltip",e)}}function Fi(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(3);p(),j("#",e.recipeObjectiveId,"")}}function Pi(t,o){if(t&1&&f(0,"lab-tooltip",71),t&2){let e=a(4);u("id",e.recipeId)("adjustedRecipe",e.recipe)}}function Ri(t,o){if(t&1&&c(0,Pi,1,2,"lab-tooltip",71),t&2){let e=a(3);r(e.recipeId?0:-1)}}function ji(t,o){if(t&1&&(_(0,"i",70),d(1,"iconSmClass"),c(2,Fi,2,1,"span")(3,Ri,1,1,"ng-template",null,6,M),s()),t&2){let e=h(4),n=a(2);O(w(1,4,n.recipeId,"recipe")),u("pTooltip",e),p(2),r(n.recipeObjectiveId!=null?2:-1)}}function $i(t,o){if(t&1&&(_(0,"td",54)(1,"div",60),c(2,Mi,3,0,"div",61),_(3,"div",62),c(4,Vi,5,6,"button",63)(5,ji,5,7,"i",64),s()()()),t&2){let e,n=a(),i=a(2),l=h(1);p(2),r(!l.sortField&&((e=i.stepTree()[n.id])!=null&&e.length)?2:-1),p(2),r(n.itemId&&n.recipeObjectiveId==null?4:5)}}function Di(t,o){if(t&1&&(_(0,"span",73),S(1),d(2,"rate"),s()),t&2){let e=a(2),n=a(2);p(),j("(+",w(2,1,e.surplus,n.columnsState().items.precision),") ")}}function Li(t,o){if(t&1&&f(0,"lab-tooltip",69),t&2){let e=a(2);u("id",e.itemId)}}function Hi(t,o){if(t&1){let e=F();_(0,"td",72),c(1,Di,3,4,"span",73),_(2,"span",74),S(3),d(4,"rate"),s()(),_(5,"td",75)(6,"div",28)(7,"span",76),S(8),s(),_(9,"button",67),d(10,"iconSmClass"),B("click",function(){E(e);let i=a(),l=a(2);return k(l.changeItemExcluded(i.itemId,!l.settings().excludedItemIds.has(i.itemId)))}),f(11,"i",68),c(12,Li,1,1,"ng-template",null,6,M),s()()()}if(t&2){let e,n=h(13),i=a(),l=a(2);p(),r(i.surplus&&i.surplus.nonzero()?1:-1),p(2),T(w(4,7,i.items.sub((e=i.surplus)!==null&&e!==void 0?e:l.rational.zero),l.columnsState().items.precision)),p(5),T(l.data().itemEntities[i.itemId].name),p(),ft("hover-active",l.settings().excludedItemIds.has(i.itemId)),u("icon",x(10,10,i.itemId))("pTooltip",n)}}function Ni(t,o){t&1&&f(0,"td",36)}function Ai(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(4);p(),T(e.stack)}}function Wi(t,o){if(t&1){let e=F();_(0,"button",78),B("click",function(i){E(e);let l=h(6);a();let m=fe(0),C=a(2);return k(l.show(i,m,C))}),_(1,"i",79),d(2,"iconSmClass"),c(3,Ai,2,1,"span"),s(),f(4,"i",80),s(),_(5,"lab-belt-overlay",81,7),B("setValue",function(i){E(e);let l=a(5),m=a(2);return k(m.changeBelts(l,i))}),s()}if(t&2){a();let e=h(4),n=a(),i=a(),l=a(4);u("pTooltip",e),p(),O(x(2,4,n)),p(2),r(i.stack!=null&&i.stack.gt(l.rational.one)?3:-1)}}function Ui(t,o){if(t&1&&(_(0,"div",51),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function zi(t,o){if(t&1&&c(0,Ui,3,4,"div",51),t&2){let e=o.$implicit;r(e?0:-1)}}function qi(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a().$implicit,n=a(2);u("id",e.value)("type",n)}}function Ji(t,o){if(t&1&&(_(0,"div",85),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,qi,1,2,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function Ki(t,o){if(t&1){let e=F();_(0,"p-dropdown",82),B("onChange",function(i){E(e);let l=a(3),m=a(2),C=a(2);return k(C.itemsSvc.updateEntityField(m.itemId,"beltId",i.value,l.defaultBeltId))}),c(1,zi,1,1,"ng-template",83)(2,Ji,7,6,"ng-template",84),s()}if(t&2){let e=a(),n=h(4),i=a(),l=a(5);u("pTooltip",n)("ngModel",i)("options",e==="belt"?l.options().belts:l.options().pipes)}}function Xi(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a(),n=a();u("id",n)("type",e)}}function Gi(t,o){if(t&1&&(ue(0),c(1,Wi,7,6)(2,Ki,3,3,"p-dropdown",77)(3,Xi,1,2,"ng-template",null,6,M)),t&2){let e=a(4),n=a(2),i=Ce(n.data().itemEntities[e.itemId].stack);p(),r(n.data().flags.has("beltStack")&&i&&i.gt(n.rational.one)?1:2)}}function Qi(t,o){if(t&1&&f(0,"lab-tooltip",88),t&2){let e=a(2);u("id",e)}}function Yi(t,o){if(t&1&&(_(0,"i",70),d(1,"iconClass"),c(2,Qi,1,1,"ng-template",null,6,M),s()),t&2){let e=h(3),n=a();O(x(1,3,n)),u("pTooltip",e)}}function Zi(t,o){if(t&1&&(_(0,"td",72)(1,"span",74),S(2),d(3,"rate"),s()(),_(4,"td",75)(5,"div",28),c(6,Gi,5,2)(7,Yi,4,5,"i",64),s()()),t&2){let e,n=o,i=a(3),l=a(2);p(2),T(w(3,2,i.belts,l.columnsState().belts.precision)),p(4),r((e=l.data().beltIds.includes(n)?"belt":l.data().pipeIds.includes(n)?"pipe":null)?6:7,e)}}function to(t,o){if(t&1&&c(0,Zi,8,5),t&2){let e;r((e=o.beltId)?0:-1,e)}}function eo(t,o){t&1&&f(0,"td",36)}function no(t,o){if(t&1&&c(0,to,1,1)(1,eo,1,0,"td",36),t&2){let e,n=a(),i=a(2);r((e=n.itemId&&n.belts&&i.itemsState()[n.itemId])?0:1,e)}}function io(t,o){if(t&1&&(_(0,"div",51),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function oo(t,o){if(t&1&&c(0,io,3,4,"div",51),t&2){let e=o.$implicit;r(e?0:-1)}}function ao(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a().$implicit,n=a();u("id",e.value)("type",n)}}function lo(t,o){if(t&1&&(_(0,"div",85),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,ao,1,2,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function po(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a(),n=a();u("id",n)("type",e)}}function _o(t,o){if(t&1){let e=F();_(0,"p-dropdown",82),B("onChange",function(i){E(e);let l=a(4),m=a(2);return k(m.itemsSvc.updateEntityField(l.itemId,"wagonId",i.value,m.itemsState()[l.itemId].defaultWagonId))}),c(1,oo,1,1,"ng-template",83)(2,lo,7,6,"ng-template",84)(3,po,1,2,"ng-template",null,6,M),s()}if(t&2){let e=h(4),n=a(),i=a(5);u("pTooltip",e)("ngModel",n)("options",o==="cargo-wagon"?i.options().cargoWagons:i.options().fluidWagons)}}function so(t,o){if(t&1&&(_(0,"td",72)(1,"span",74),S(2),d(3,"rate"),s()(),_(4,"td",75)(5,"div",28),c(6,_o,5,3,"p-dropdown",77),s()()),t&2){let e,n=o,i=a(3),l=a(2);p(2),T(w(3,2,i.wagons,l.columnsState().wagons.precision)),p(4),r((e=l.data().cargoWagonIds.includes(n)?"cargo-wagon":l.data().fluidWagonIds.includes(n)?"fluid-wagon":null)?6:-1,e)}}function co(t,o){if(t&1&&c(0,so,7,5),t&2){let e,n=a(2),i=a(2);r((e=i.itemsState()[n.itemId].wagonId)?0:-1,e)}}function ro(t,o){t&1&&f(0,"td",36)}function mo(t,o){if(t&1&&c(0,co,1,1)(1,ro,1,0,"td",36),t&2){let e=a();r(e.itemId&&e.wagons?0:1)}}function uo(t,o){if(t&1&&(_(0,"span",74),S(1),d(2,"rate"),s()),t&2){let e=a(2),n=a(2);p(),T(w(2,1,e.rockets,n.columnsState().rockets.precision))}}function Co(t,o){t&1&&(f(0,"i"),d(1,"iconClass")),t&2&&O(x(1,2,"rocket-silo"))}function fo(t,o){if(t&1&&(_(0,"td",72),c(1,uo,3,4,"span",74),s(),_(2,"td"),c(3,Co,2,4,"i",89),s()),t&2){let e=a();p(),r(e.rockets&&e.rockets.nonzero()?1:-1),p(2),r(e.rockets&&e.rockets.nonzero()?3:-1)}}function xo(t,o){if(t&1&&(_(0,"span",74),S(1),d(2,"machineRate"),s()),t&2){let e=a(),n=a(),i=a(2);p(),T(gt(2,1,n.machines,i.columnsState().machines.precision,e))}}function go(t,o){t&1&&R(0)}function So(t,o){if(t&1&&(_(0,"div",51),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function vo(t,o){if(t&1&&c(0,So,3,4,"div",51),t&2){let e=o.$implicit;r(e?0:-1)}}function ho(t,o){if(t&1&&f(0,"lab-tooltip",94),t&2){let e=a().$implicit;u("id",e.value)}}function bo(t,o){if(t&1&&(_(0,"div",85),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,ho,1,1,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function Io(t,o){if(t&1&&f(0,"lab-tooltip",94),t&2){let e=a(3);u("id",e)}}function To(t,o){if(t&1){let e=F();_(0,"p-dropdown",93),B("onChange",function(i){E(e);let l=a(3),m=a(2);return k(l.recipeObjectiveId?m.objectivesSvc.updateEntityField(l.recipeObjectiveId,"machineId",i.value,l.recipeSettings.defaultMachineId):m.recipesSvc.updateEntityField(l.recipeId,"machineId",i.value,l.recipeSettings.defaultMachineId))}),c(1,vo,1,1,"ng-template",83)(2,bo,7,6,"ng-template",84)(3,Io,1,1,"ng-template",null,6,M),s()}if(t&2){let e=h(4),n=a(2),i=a();u("pTooltip",e)("options",i.recipeSettings.machineOptions)("ngModel",n)}}function yo(t,o){if(t&1){let e=F();_(0,"p-inputNumber",95,8),d(2,"translate"),B("onBlur",function(){let i;E(e);let l=h(1),m=a(3),C=a(2);return k(m.recipeObjectiveId?C.objectivesSvc.updateEntityField(m.recipeObjectiveId,"overclock",C.rational((i=l.value)!==null&&i!==void 0?i:100),m.recipeSettings.defaultOverclock):C.recipesSvc.updateEntityField(m.recipeId,"overclock",C.rational((i=l.value)!==null&&i!==void 0?i:100),m.recipeSettings.defaultOverclock))}),s()}if(t&2){let e=a(3);u("min",1)("max",250)("step",10)("maxFractionDigits",2)("size",3)("pTooltip",x(2,7,"steps.overclockTooltip"))("ngModel",e.recipeSettings.overclock)}}function wo(t,o){if(t&1&&f(0,"lab-tooltip",97),t&2){let e=a(2);u("id",e)}}function Eo(t,o){if(t&1&&(_(0,"div",28)(1,"i",96),d(2,"iconSmClass"),c(3,wo,1,1,"ng-template",null,6,M),s()()),t&2){let e=h(4),n=a();p(),O(x(2,3,n)),u("pTooltip",e)}}function ko(t,o){if(t&1&&(_(0,"div",51),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=o.$implicit;p(),O(x(2,2,e.value))}}function Bo(t,o){if(t&1&&f(0,"lab-tooltip",97),t&2){let e=a().$implicit;u("id",e.value)}}function Mo(t,o){if(t&1&&(_(0,"div",85),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,Bo,1,1,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function Oo(t,o){if(t&1&&f(0,"lab-tooltip",97),t&2){let e=a(2);u("id",e)}}function Vo(t,o){if(t&1){let e=F();_(0,"p-dropdown",82),B("onChange",function(i){E(e);let l=a(4),m=a(2);return k(l.recipeObjectiveId?m.objectivesSvc.updateEntityField(l.recipeObjectiveId,"fuelId",i.value,l.recipeSettings.fuelId):m.recipesSvc.updateEntityField(l.recipeId,"fuelId",i.value,l.recipeSettings.defaultFuelId))}),c(1,ko,3,4,"ng-template",83)(2,Mo,7,6,"ng-template",84)(3,Oo,1,1,"ng-template",null,6,M),s()}if(t&2){let e,n=h(4),i=a(),l=a(3);u("pTooltip",n)("ngModel",i)("options",(e=l.recipeSettings.fuelOptions)!==null&&e!==void 0?e:Y(3,fn))}}function Fo(t,o){if(t&1&&c(0,Eo,5,5,"div",28)(1,Vo,5,4,"p-dropdown",77),t&2){let e=a(3);r(e.recipe.flags.has("burn")?0:e.recipeSettings.machineId?1:-1)}}function Po(t,o){if(t&1&&(_(0,"div",51),f(1,"i"),d(2,"iconSmClass"),s()),t&2){let e=o.$implicit;p(),O(x(2,2,e.value))}}function Ro(t,o){if(t&1&&f(0,"lab-tooltip",100),t&2){let e=a().$implicit;u("id",e.value)}}function jo(t,o){if(t&1&&(_(0,"div",85),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,Ro,1,1,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",e.value!=="module"?n:void 0),p(),O(x(2,4,e.value)),p(3),j(" ",e.label," ")}}function $o(t,o){if(t&1){let e=F();_(0,"p-dropdown",99),d(1,"translate"),B("onChange",function(i){E(e);let l=a(5),m=a(2);return k(m.changeModulesBeacons(l,{modules:[{id:i.value,count:m.rational.one}]}))}),c(2,Po,3,4,"ng-template",83)(3,jo,7,6,"ng-template",84),s()}if(t&2){let e,n=a(2),i=a(3);u("pTooltip",x(1,3,"settings.modifierTooltip"))("ngModel",n[0].id)("options",(e=i.recipeSettings.moduleOptions)!==null&&e!==void 0?e:Y(5,fn))}}function Do(t,o){if(t&1&&(_(0,"i",79),d(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=o.$implicit;O(x(1,3,e.id)),p(3),T(e.count)}}function Lo(t,o){if(t&1&&f(0,"lab-tooltip",100),t&2){let e=a().$implicit;u("id",e.id)}}function Ho(t,o){if(t&1&&c(0,Lo,1,1,"lab-tooltip",100),t&2){let e=o.$implicit;r(e.id?0:-1)}}function No(t,o){if(t&1&&H(0,Ho,1,1,null,null,zt),t&2){let e=a(3);N(e)}}function Ao(t,o){if(t&1){let e=F();_(0,"button",101),B("click",function(i){E(e);let l=h(5),m=a(),C=a(),g=a(3);return k(l.show(i,C,m,g.recipeId))}),H(1,Do,4,5,"i",102,zt),f(3,"i",80),s(),_(4,"lab-modules-overlay",81,9),B("setValue",function(i){E(e);let l=a(5),m=a(2);return k(m.changeModulesBeacons(l,{modules:i}))}),s(),c(6,No,2,0,"ng-template",null,6,M)}if(t&2){let e=h(7),n=a(2);u("pTooltip",e),p(),N(n)}}function Wo(t,o){if(t&1&&c(0,$o,4,6,"p-dropdown",98)(1,Ao,8,1),t&2){let e=o;r(e.modules!==!0&&(e.modules!=null&&e.modules.isOne())?0:e.modules!=null?1:-1)}}function Uo(t,o){if(t&1&&c(0,Wo,2,1),t&2){let e,n=a(2),i=a(3);r((e=i.data().machineEntities[n])?0:-1,e)}}function zo(t,o){if(t&1&&(_(0,"div",28)(1,"span",76),S(2),s(),c(3,go,1,0,"ng-container",90)(4,To,5,3,"p-dropdown",91)(5,yo,3,9,"p-inputNumber",92)(6,Fo,2,1)(7,Uo,1,1),s()),t&2){let e,n,i=a(2),l=h(18),m=a(2);p(2),T(i.recipe.name),p(),u("ngTemplateOutlet",l),p(),r(i.recipe.flags.has("hideProducer")?-1:4),p(),r(m.data().flags.has("overclock")?5:-1),p(),r((e=i.recipeSettings==null?null:i.recipeSettings.fuelId)?6:-1,e),p(),r((n=i.recipeSettings==null?null:i.recipeSettings.modules)?7:-1,n)}}function qo(t,o){if(t&1&&(_(0,"td",72),c(1,xo,3,5,"span",74),s(),_(2,"td",75),c(3,zo,8,6,"div",28),s()),t&2){let e=a(),n=a(2);p(),r(e.machines&&e.machines.nonzero()&&!n.data().machineEntities[o].hideRate?1:-1),p(2),r(e.recipeId&&e.recipe&&e.recipeSettings?3:-1)}}function Jo(t,o){t&1&&R(0)}function Ko(t,o){if(t&1&&(f(0,"td"),_(1,"td",75),c(2,Jo,1,0,"ng-container",90),s()),t&2){a();let e=h(18);p(2),u("ngTemplateOutlet",e)}}function Xo(t,o){if(t&1&&(f(0,"lab-tooltip",106),d(1,"translate")),t&2){let e=a(4);u("id",e.recipeId)("adjustedRecipe",e.recipe)("action",x(1,3,"steps.selectRecipesTooltip"))}}function Go(t,o){t&1&&(S(0),d(1,"translate")),t&2&&j(" ",x(1,1,"steps.selectRecipesTooltip")," ")}function Qo(t,o){if(t&1&&c(0,Xo,2,5,"lab-tooltip",106)(1,Go,2,3),t&2){let e=a(3);r(e.recipeId?0:1)}}function Yo(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(5);p(),j("#",e.recipeObjectiveId,"")}}function Zo(t,o){if(t&1&&(_(0,"div",51)(1,"i"),d(2,"iconSmClass"),c(3,Yo,2,1,"span"),s()()),t&2){let e=a(4);p(),O(w(2,3,e.recipeId,"recipe")),p(2),r(e.recipeObjectiveId?3:-1)}}function ta(t,o){t&1&&f(0,"i",107)}function ea(t,o){if(t&1&&c(0,Zo,4,6,"div",51)(1,ta,1,0,"i",107),t&2){let e=a(3);r(e.recipeId?0:1)}}function na(t,o){if(t&1&&f(0,"lab-tooltip",109),t&2){let e=a().$implicit;u("id",e.value)}}function ia(t,o){if(t&1&&(_(0,"div",108),f(1,"i"),d(2,"iconSmClass"),_(3,"div",86),S(4),s(),c(5,na,1,1,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);u("pTooltip",n),p(),O(w(2,4,e.value,"recipe")),p(3),j(" ",e.label," ")}}function oa(t,o){if(t&1){let e=F();_(0,"p-multiSelect",104),ot("ngModelChange",function(i){let l=E(e);return it(l.recipesEnabled,i)||(l.recipesEnabled=i),k(i)}),B("onPanelHide",function(){let i=E(e),l=a(4);return k(l.changeRecipesIncluded(i.recipeIds,i.recipesEnabled))}),c(1,Qo,2,1,"ng-template",null,6,M)(3,ea,2,1,"ng-template",105)(4,ia,7,7,"ng-template",84),s()}if(t&2){let e=o,n=h(2);nt("ngModel",e.recipesEnabled),u("options",e.recipeOptions)("pTooltip",n)}}function aa(t,o){if(t&1&&c(0,oa,5,3,"p-multiSelect",103),t&2){let e,n=a(),i=a(2);r((e=i.stepDetails()[n.id])?0:-1,e)}}function la(t,o){if(t&1&&(_(0,"i",112),d(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=a().$implicit;O(x(1,3,e.id)),p(3),T(e.total)}}function pa(t,o){if(t&1&&(_(0,"i",79),d(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=o.$implicit;O(x(1,3,e.id)),p(3),T(e.count)}}function _a(t,o){if(t&1&&(_(0,"div",51)(1,"i",79),d(2,"iconSmClass"),_(3,"span"),S(4),s()(),c(5,la,4,5,"i",111),H(6,pa,4,5,"i",102,zt),s()),t&2){let e=o.$implicit;p(),O(x(2,4,e.id)),p(3),T(e.count),p(),r(e.total?5:-1),p(),N(e.modules)}}function sa(t,o){t&1&&f(0,"lab-tooltip",113),t&2&&u("id",o)}function ca(t,o){if(t&1&&c(0,sa,1,1,"lab-tooltip",113),t&2){let e,n=a(3);r((e=n.recipeSettings.beacons==null||n.recipeSettings.beacons[0]==null?null:n.recipeSettings.beacons[0].id)?0:-1,e)}}function ra(t,o){if(t&1){let e=F();_(0,"button",110),B("click",function(i){E(e);let l=h(5),m=a(2);return k(l.show(i,m.recipeSettings.beacons))}),H(1,_a,8,6,"div",51,Tt),f(3,"i",80),s(),_(4,"lab-beacons-overlay",81,10),B("setValue",function(i){E(e);let l=a(2),m=a(2);return k(m.changeModulesBeacons(l,{beacons:i}))}),s(),c(6,ca,1,1,"ng-template",null,6,M)}if(t&2){let e=h(7),n=a(2);u("pTooltip",e),p(),N(n.recipeSettings.beacons)}}function da(t,o){if(t&1&&(_(0,"td",55),c(1,ra,8,1),s()),t&2){let e=a();p(),r(e.recipeId&&e.recipeSettings&&e.recipeSettings.beacons&&e.recipeSettings.beacons.length?1:-1)}}function ma(t,o){if(t&1&&(_(0,"span",74),S(1),d(2,"power"),s()),t&2){let e=a(2),n=a(2);p(),T(gt(2,1,e.power,n.columnsState().power.precision,n.effectivePowerUnit()))}}function ua(t,o){if(t&1&&(_(0,"td",56),c(1,ma,3,5,"span",74),s()),t&2){let e=a();p(),r(e.power&&e.power.nonzero()?1:-1)}}function Ca(t,o){if(t&1&&(_(0,"span",74),S(1),d(2,"rate"),s()),t&2){let e=a(2),n=a(2);p(),T(w(2,1,e.pollution,n.columnsState().pollution.precision))}}function fa(t,o){if(t&1&&(_(0,"td",56),c(1,Ca,3,4,"span",74),s()),t&2){let e=a();p(),r(e.pollution&&e.pollution.nonzero()?1:-1)}}function xa(t,o){if(t&1){let e=F();_(0,"button",117),d(1,"translate"),B("click",function(){E(e);let i=a(2),l=a(2);return k(l.resetStep(i))}),s()}t&2&&u("pTooltip",x(1,1,"steps.stepUndoTooltip"))}function ga(t,o){if(t&1&&(_(0,"td",57)(1,"div",51)(2,"a",114),d(3,"stepHref"),d(4,"async"),f(5,"button",115),d(6,"translate"),s(),c(7,xa,2,3,"button",116),s()()),t&2){let e=a(),n=a(2);p(2),u("queryParams",x(4,6,w(3,3,e,n.routerSvc.zipConfig()))),p(3),u("pTooltip",x(6,8,"steps.openNewTabTooltip")),p(2),r(e.recipeId&&n.stepsModified().recipes[e.recipeId]||e.itemId&&n.stepsModified().items[e.itemId]||e.recipeObjectiveId&&n.stepsModified().objectives[e.recipeObjectiveId]?7:-1)}}function Sa(t,o){if(t&1){let e=F();_(0,"tr")(1,"td",49),f(2,"div",50),H(3,Ei,1,1,"div",50,zt),_(5,"div",51)(6,"button",52),d(7,"translate"),B("click",function(){let i=E(e),l=a().expanded,m=a();return k(m.expandRow(i,l))}),s()()(),c(8,ki,3,2,"td",53)(9,$i,6,2,"td",54)(10,Hi,14,12)(11,Ni,1,0,"td",36)(12,no,2,1)(13,mo,2,1)(14,fo,4,2)(15,qo,4,2)(16,Ko,3,1)(17,aa,1,1,"ng-template",null,5,M)(19,da,2,1,"td",55)(20,ua,2,1,"td",56)(21,fa,2,1,"td",56)(22,ga,8,10,"td",57),s()}if(t&2){let e,n=o,i=a().expanded,l=a();p(2),u("id","step_"+n.id),p(),N(l.stepDetails()[n.id].tabs),p(3),ft("fa-rotate-90",i),u("pTooltip",x(7,16,i?"steps.hideDetails":"steps.showDetails"))("pRowToggler",n),p(2),r(!l.focus()&&l.columnsState().checkbox.show?8:-1),p(),r(!l.focus()&&l.columnsState().tree.show?9:-1),p(),r(n.itemId&&n.items?10:11),p(2),r(l.columnsState().belts.show?12:-1),p(),r(l.columnsState().wagons.show?13:-1),p(),r(l.columnsState().rockets.show?14:-1),p(),r((e=n.recipeSettings==null?null:n.recipeSettings.machineId)?15:16,e),p(4),r(l.columnsState().beacons.show?19:-1),p(),r(l.columnsState().power.show?20:-1),p(),r(l.columnsState().pollution.show?21:-1),p(),r(l.columnsState().link.show?22:-1)}}function va(t,o){if(t&1&&(c(0,Sa,23,18,"tr"),d(1,"asStep")),t&2){let e,n=o.$implicit;r((e=x(1,1,n))?0:-1,e)}}function ha(t,o){if(t&1&&(_(0,"a",124),f(1,"span",125),_(2,"span",126),S(3),d(4,"translate"),s()()),t&2){let e=o.$implicit,n=a(3);u("id",e.id),p(),O(n.stepDetailIcon[e.label]),p(2),T(x(4,4,"options.stepDetailTab."+e.label))}}function ba(t,o){t&1&&R(0)}function Ia(t,o){if(t&1&&(_(0,"tr",123),c(1,ba,1,0,"ng-container",90),_(2,"td",127),S(3),d(4,"translate"),s()()),t&2){a(4);let e=h(9);p(),u("ngTemplateOutlet",e),p(2),j(" ",x(4,2,"steps.sources")," ")}}function Ta(t,o){t&1&&R(0)}function ya(t,o){if(t&1&&c(0,Ta,1,0,"ng-container",128),t&2){let e=a().$implicit,n=a(2),i=a(2),l=h(11);u("ngTemplateOutlet",l)("ngTemplateOutletContext",lt(2,Jn,[n.items==null?null:n.items.mul(e.value),n.itemId,n.belts==null?null:n.belts.mul(e.value),i.itemsState()[n.itemId].beltId,i.itemsState()[n.itemId].stack,n.wagons==null?null:n.wagons.mul(e.value),i.itemsState()[n.itemId].wagonId,e.step==null?null:e.step.machines,e.step==null||e.step.recipeSettings==null?null:e.step.recipeSettings.machineId,e.step==null?null:e.step.recipeId,e.step==null?null:e.step.recipeObjectiveId,e.value,n.itemId,e.inputs]))}}function wa(t,o){if(t&1&&c(0,ya,1,17,"ng-container"),t&2){let e=a(2);r(e.itemId?0:-1)}}function Ea(t,o){t&1&&R(0)}function ka(t,o){if(t&1&&(_(0,"tr",123),c(1,Ea,1,0,"ng-container",90),_(2,"td",127),S(3),d(4,"translate"),s()()),t&2){a(4);let e=h(9);p(),u("ngTemplateOutlet",e),p(2),j(" ",x(4,2,"steps.destinations")," ")}}function Ba(t,o){t&1&&R(0)}function Ma(t,o){if(t&1&&c(0,Ba,1,0,"ng-container",128),t&2){let e,n=a().$implicit,i=a(2),l=a(2),m=h(11);u("ngTemplateOutlet",m)("ngTemplateOutletContext",lt(2,Kn,[i.items==null?null:i.items.mul(n.value),i.itemId,i.belts==null?null:i.belts.mul(n.value),l.itemsState()[i.itemId].beltId,l.itemsState()[i.itemId].stack,i.wagons==null?null:i.wagons.mul(n.value),l.itemsState()[i.itemId].wagonId,l.stepDetails()[i.id].outputs.length===1?i.machines==null?null:i.machines.mul(n.value):null,l.stepDetails()[i.id].outputs.length===1?i.recipeSettings==null?null:i.recipeSettings.machineId:null,i.recipeId,i.recipeObjectiveId,n.value,(e=l.stepById()[n.key])==null?null:e.recipeId,(e=l.stepById()[n.key])==null?null:e.recipeObjectiveId,n.key===""]))}}function Oa(t,o){if(t&1&&c(0,Ma,1,18,"ng-container"),t&2){let e=a(2);r(e.itemId?0:-1)}}function Va(t,o){if(t&1&&(c(0,Ia,5,4,"tr",123),H(1,wa,1,1,null,null,Tt),c(3,ka,5,4,"tr",123),H(4,Oa,1,1,null,null,q),d(6,"keyvalue")),t&2){let e=a(),n=a(2);r(n.stepDetails()[e.id].outputs.length?0:-1),p(),N(n.stepDetails()[e.id].outputs),p(2),r(e.parents?3:-1),p(),N(w(6,2,e.parents,n.trackSvc.sortByValue))}}function Fa(t,o){t&1&&R(0)}function Pa(t,o){t&1&&R(0)}function Ra(t,o){if(t&1&&c(0,Pa,1,0,"ng-container",128),t&2){let e=a(),n=a().$implicit,i=a(4);a(2);let l=h(11);u("ngTemplateOutlet",l)("ngTemplateOutletContext",J(2,Xn,e.items.mul(o).div(i.recipe.effects.productivity),n.key))}}function ja(t,o){if(t&1&&c(0,Ra,1,5,"ng-container"),t&2){let e,n=a().$implicit,i=a(4);r((e=o.items&&(i.outputs==null?null:i.outputs[n.key]))?0:-1,e)}}function $a(t,o){if(t&1&&c(0,ja,1,1),t&2){let e,n=o.$implicit,i=a(6);r((e=i.stepByItemEntities()[n.key])?0:-1,e)}}function Da(t,o){if(t&1&&(_(0,"tr",123),c(1,Fa,1,0,"ng-container",90),_(2,"td",127),S(3),d(4,"translate"),s()(),H(5,$a,1,1,null,null,q),d(7,"keyvalue")),t&2){let e=a(3),n=a(2),i=h(9);p(),u("ngTemplateOutlet",i),p(2),j(" ",x(4,2,"steps.depletion")," "),p(2),N(w(7,4,e.outputs,n.trackSvc.sortByValue))}}function La(t,o){t&1&&R(0)}function Ha(t,o){t&1&&R(0)}function Na(t,o){if(t&1&&c(0,Ha,1,0,"ng-container",128),t&2){let e=o,n=a(),i=a(),l=a().$implicit,m=a(4),C=a(2),g=h(11);u("ngTemplateOutlet",g)("ngTemplateOutletContext",lt(2,Gn,[i.items==null?null:i.items.mul(n),l.key,i.belts==null?null:i.belts.mul(n),C.itemsState()[i.itemId].beltId,C.itemsState()[i.itemId].stack,i.wagons==null?null:i.wagons.mul(n),C.itemsState()[i.itemId].wagonId,e.step==null||e.step.machines==null?null:e.step.machines.mul(n),e.step==null||e.step.recipeSettings==null?null:e.step.recipeSettings.machineId,e.step==null?null:e.step.recipeId,e.step==null?null:e.step.recipeObjectiveId,n,m.recipeId,m.recipeObjectiveId]))}}function Aa(t,o){t&1&&R(0)}function Wa(t,o){if(t&1&&c(0,Aa,1,0,"ng-container",128),t&2){let e=a(),n=a(),i=a().$implicit,l=a(4),m=a(2),C=h(11);u("ngTemplateOutlet",C)("ngTemplateOutletContext",lt(2,Qn,[n.items==null?null:n.items.mul(e),i.key,n.belts==null?null:n.belts.mul(e),m.itemsState()[n.itemId].beltId,m.itemsState()[n.itemId].stack,n.wagons==null?null:n.wagons.mul(e),m.itemsState()[n.itemId].wagonId,e,l.recipeId,l.recipeObjectiveId]))}}function Ua(t,o){if(t&1&&c(0,Na,1,17,"ng-container")(1,Wa,1,13,"ng-container"),t&2){let e,n=a(),i=a(7);r((e=i.stepDetails()[n.id].outputs.length===1&&i.stepDetails()[n.id].outputs[0])?0:1,e)}}function za(t,o){if(t&1&&c(0,Ua,2,1),t&2){let e,n=o,i=a(5);r((e=n.itemId&&(n.parents==null?null:n.parents[i.id]))?0:-1,e)}}function qa(t,o){if(t&1&&c(0,za,1,1),t&2){let e,n=o.$implicit,i=a(6);r((e=i.stepByItemEntities()[n.key])?0:-1,e)}}function Ja(t,o){if(t&1&&(_(0,"tr",123),c(1,La,1,0,"ng-container",90),_(2,"td",127),S(3),d(4,"translate"),s()(),H(5,qa,1,1,null,null,q),d(7,"keyvalue")),t&2){let e=a(3),n=a(2),i=h(9);p(),u("ngTemplateOutlet",i),p(2),j(" ",x(4,2,"steps.inputs")," "),p(2),N(w(7,4,e.recipe.in,n.trackSvc.sortByValue))}}function Ka(t,o){t&1&&R(0)}function Xa(t,o){t&1&&R(0)}function Ga(t,o){t&1&&R(0)}function Qa(t,o){t&1&&R(0)}function Ya(t,o){if(t&1&&c(0,Qa,1,0,"ng-container",128),t&2){let e=o,n=a(),i=a().$implicit,l=a(3),m=a(2),C=h(11);u("ngTemplateOutlet",C)("ngTemplateOutletContext",lt(2,Yn,[n.items==null?null:n.items.mul(e),i.key,n.belts==null?null:n.belts.mul(e),m.itemsState()[n.itemId].beltId,m.itemsState()[n.itemId].stack,n.wagons==null?null:n.wagons.mul(e),m.itemsState()[n.itemId].wagonId,l.machines,l.recipeSettings==null?null:l.recipeSettings.machineId,l.recipeId,l.recipeObjectiveId,e,i.key,l.recipeObjectiveId]))}}function Za(t,o){if(t&1&&c(0,Ya,1,17,"ng-container"),t&2){let e,n=a().$implicit,i=a(3);r((e=o.itemId&&(i.outputs==null?null:i.outputs[n.key]))?0:-1,e)}}function tl(t,o){if(t&1&&c(0,Za,1,1),t&2){let e,n=o.$implicit,i=a(5);r((e=i.stepByItemEntities()[n.key])?0:-1,e)}}function el(t,o){if(t&1&&(c(0,Da,8,7)(1,Ja,8,7),d(2,"keyvalue"),_(3,"tr",123),c(4,Ka,1,0,"ng-container",90),_(5,"td",127),S(6),d(7,"translate"),s()(),_(8,"tr",123),c(9,Xa,1,0,"ng-container",90),_(10,"td",129)(11,"span",74),S(12),d(13,"rate"),s()(),_(14,"td",130)(15,"div",51),f(16,"i",131),s()(),f(17,"td",22),s(),_(18,"tr",123),c(19,Ga,1,0,"ng-container",90),_(20,"td",127),S(21),d(22,"translate"),s()(),H(23,tl,1,1,null,null,q),d(25,"keyvalue")),t&2){let e=a(2),n=a(2),i=h(9);r(n.data().flags.has("miningDepletion")&&e.recipe.flags.has("mining")?0:-1),p(),r(x(2,8,e.recipe.in).length?1:-1),p(3),u("ngTemplateOutlet",i),p(2),j(" ",x(7,10,"steps.time")," "),p(3),u("ngTemplateOutlet",i),p(3),T(w(13,12,e.recipe.time,n.columnsState().items.precision)),p(7),u("ngTemplateOutlet",i),p(2),j(" ",x(22,15,"steps.outputs")," "),p(2),N(w(25,17,e.recipe.out,n.trackSvc.sortByValue))}}function nl(t,o){if(t&1&&c(0,el,26,20),t&2){let e=a();r(e.recipe?0:-1)}}function il(t,o){t&1&&R(0)}function ol(t,o){if(t&1&&(c(0,il,1,0,"ng-container",128),d(1,"rate")),t&2){let e=a(),n=a(),i=a().$implicit;a();let l=h(28),m=a(2),C=a(2);u("ngTemplateOutlet",l)("ngTemplateOutletContext",J(5,qt,w(1,2,n.items.mul(e).div(m.machines),C.columnsState().items.precision),i.key))}}function al(t,o){t&1&&R(0)}function ll(t,o){if(t&1&&(c(0,al,1,0,"ng-container",128),d(1,"rate")),t&2){let e=a(3),n=a(),i=a().$implicit;a();let l=h(28),m=a(2),C=a(2);u("ngTemplateOutlet",l)("ngTemplateOutletContext",xt(5,xn,w(1,2,n.belts.mul(e).div(m.machines),C.columnsState().belts.precision),o,C.itemsState()[i.key].stack))}}function pl(t,o){if(t&1&&c(0,ll,2,9,"ng-container"),t&2){let e,n=a(4).$implicit,i=a(5);r((e=i.itemsState()[n.key].beltId)?0:-1,e)}}function _l(t,o){if(t&1&&(_(0,"td"),c(1,pl,1,1),s()),t&2){let e=a(2);p(),r(e.belts?1:-1)}}function sl(t,o){t&1&&R(0)}function cl(t,o){if(t&1&&(c(0,sl,1,0,"ng-container",128),d(1,"rate")),t&2){let e=o;a(6);let n=h(28);u("ngTemplateOutlet",n)("ngTemplateOutletContext",J(5,qt,w(1,2,e.value,1),e.id))}}function rl(t,o){if(t&1&&(c(0,cl,2,8,"ng-container"),d(1,"inserterSpeed")),t&2){let e,n=a(2),i=a(),l=a(4),m=a(2);r((e=w(1,1,i.items.mul(n).div(l.machines).div(m.dispRateInfo().value),m.settings()))?0:-1,e)}}function dl(t,o){if(t&1&&(_(0,"td"),c(1,rl,2,4),s()),t&2){let e=a(2),n=a().$implicit,i=a(5);p(),r(i.data().itemEntities[n.key].stack&&e.items?1:-1)}}function ml(t,o){if(t&1&&(_(0,"tr")(1,"td"),c(2,ol,2,8,"ng-container"),s(),c(3,_l,2,1,"td")(4,dl,2,1,"td"),s()),t&2){let e=a(),n=a(6);p(2),r(e.items?2:-1),p(),r(n.columnsState().belts.show?3:-1),p(),r(n.data().flags.has("inserterEstimation")?4:-1)}}function ul(t,o){if(t&1&&c(0,ml,5,3,"tr"),t&2){let e,n=o,i=a(4);r((e=n.parents==null?null:n.parents[i.id])?0:-1,e)}}function Cl(t,o){if(t&1&&c(0,ul,1,1),t&2){let e,n=o.$implicit,i=a(5);r((e=i.stepByItemEntities()[n.key])?0:-1,e)}}function fl(t,o){t&1&&f(0,"i",134)}function xl(t,o){if(t&1&&f(0,"lab-tooltip",109),t&2){let e=a(4);u("id",e.recipeId)}}function gl(t,o){if(t&1&&f(0,"lab-tooltip",94),t&2){let e=a();u("id",e)}}function Sl(t,o){if(t&1&&(_(0,"div",28)(1,"i",70),d(2,"iconClass"),c(3,xl,1,1,"ng-template",null,6,M),s(),_(5,"i",70),d(6,"iconClass"),c(7,gl,1,1,"ng-template",null,6,M),s()()),t&2){let e=h(4),n=a(3);p(),O(w(2,6,n.recipeId,"recipe")),u("pTooltip",e),p(4),O(x(6,9,o)),u("pTooltip",e)}}function vl(t,o){t&1&&R(0)}function hl(t,o){if(t&1&&(c(0,vl,1,0,"ng-container",128),d(1,"rate")),t&2){let e=o;a(5);let n=h(28);u("ngTemplateOutlet",n)("ngTemplateOutletContext",J(5,qt,w(1,2,e.value,1),e.id))}}function bl(t,o){if(t&1&&(c(0,hl,2,8,"ng-container"),d(1,"inserterSpeed")),t&2){let e,n=a(2),i=a(6);r((e=w(1,1,n,i.settings()))?0:-1,e)}}function Il(t,o){if(t&1&&(_(0,"td"),c(1,bl,2,4),s()),t&2){let e=a(2).$implicit,n=a(5);p(),r(n.data().itemEntities[e.key].stack?1:-1)}}function Tl(t,o){t&1&&R(0)}function yl(t,o){if(t&1&&(c(0,Tl,1,0,"ng-container",128),d(1,"rate")),t&2){let e=o,n=a(2),i=a().$implicit;a();let l=h(28),m=a(4);u("ngTemplateOutlet",l)("ngTemplateOutletContext",xt(5,xn,w(1,2,n.div(m.beltSpeed()[e]),m.columnsState().belts.precision),e,m.itemsState()[i.key].stack))}}function wl(t,o){if(t&1&&(_(0,"td"),c(1,yl,2,9,"ng-container"),s()),t&2){let e,n=a(2).$implicit,i=a(5);p(),r((e=i.itemsState()[n.key].beltId)?1:-1,e)}}function El(t,o){t&1&&R(0)}function kl(t,o){if(t&1&&(_(0,"tr"),c(1,Il,2,1,"td")(2,wl,2,1,"td"),_(3,"td"),c(4,El,1,0,"ng-container",128),d(5,"rate"),s()()),t&2){let e=a().$implicit;a();let n=h(28),i=a(4);p(),r(i.data().flags.has("inserterEstimation")?1:-1),p(),r(i.columnsState().belts.show?2:-1),p(2),u("ngTemplateOutlet",n)("ngTemplateOutletContext",J(7,qt,w(5,4,o.mul(i.dispRateInfo().value),i.columnsState().items.precision),e.key))}}function Bl(t,o){if(t&1&&c(0,kl,6,10,"tr"),t&2){let e,n=o.$implicit,i=a(3);r((e=n.value.div(i.recipe.time))?0:-1,e)}}function Ml(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a().stack;p(),T(e)}}function Ol(t,o){if(t&1&&f(0,"lab-tooltip",69),t&2){let e=a().itemId;u("id",e)}}function Vl(t,o){if(t&1&&(_(0,"div",46)(1,"span",74),S(2),s(),_(3,"i",96),d(4,"iconSmClass"),c(5,Ml,2,1,"span")(6,Ol,1,1,"ng-template",null,6,M),s()()),t&2){let e=o.value,n=o.itemId,i=o.stack,l=h(7),m=a(5);p(2),T(e),p(),O(x(4,5,n)),u("pTooltip",l),p(2),r(i!=null&&i.gt(m.rational.one)?5:-1)}}function Fl(t,o){if(t&1&&(_(0,"div",28)(1,"table",133),H(2,Cl,1,1,null,null,q),d(4,"keyvalue"),s(),c(5,fl,1,0,"i",134),d(6,"keyvalue"),_(7,"table",133)(8,"tr")(9,"td",129)(10,"span",74),S(11),d(12,"rate"),s()(),_(13,"td"),c(14,Sl,9,11,"div",28),s()(),_(15,"tr")(16,"td",129)(17,"span",74),S(18),d(19,"rate"),s()(),_(20,"td"),f(21,"i",131),s()()(),f(22,"i",134),_(23,"table",133),H(24,Bl,1,1,null,null,q),d(26,"keyvalue"),s(),c(27,Vl,8,7,"ng-template",null,12,M),s()),t&2){let e,n=a(2),i=a(2);p(2),N(w(4,4,n.recipe.in,i.trackSvc.sortByValue)),p(3),r(x(6,7,n.recipe.in).length?5:-1),p(6),T(w(12,9,i.rational.one,i.columnsState().machines.precision)),p(3),r((e=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:-1,e),p(4),T(w(19,12,i.dispRateInfo().value,i.columnsState().machines.precision)),p(6),N(w(26,15,n.recipe.out,i.trackSvc.sortByValue))}}function Pl(t,o){t&1&&(f(0,"small",132),d(1,"translate")),t&2&&u("innerHTML",x(1,1,"steps.inserterCountInfo"),se)}function Rl(t,o){if(t&1&&(_(0,"tr",123),f(1,"td"),_(2,"td",22),c(3,Fl,29,18,"div",28)(4,Pl,2,3,"small",132),s()()),t&2){let e=a(),n=a(2);p(3),r(e.recipeId&&e.recipe&&e.machines?3:-1),p(),r(n.data().flags.has("inserterEstimation")?4:-1)}}function jl(t,o){t&1&&(_(0,"tr",123),f(1,"td"),_(2,"td",135),S(3," This functionality has been moved. The recipe icon in the machines column now opens a multiselect dropdown to select enabled recipes. "),s()())}function $l(t,o){if(t&1){let e=F();_(0,"tr",118)(1,"td",119)(2,"a",120),f(3,"button",121),s()(),_(4,"td",22)(5,"p-tabMenu",122,11),d(7,"stepId"),B("activeItemChange",function(i){let l=E(e),m=a(2);return k(m.setActiveItem(l,i))}),c(8,ha,5,6,"ng-template",84),s()()(),c(9,Va,7,5)(10,nl,1,1)(11,Rl,5,2,"tr",123)(12,jl,4,0,"tr",123)}if(t&2){let e,n=o,i=h(6),l=a(2);p(2),u("relativeTo",l.route)("fragment",n.id),p(3),u("model",l.stepDetails()[n.id].tabs)("activeItem",l.activeItem[x(7,5,n)]),p(4),r((e=i.activeItem==null?null:i.activeItem.label)===l.StepDetailTab.Item?9:e===l.StepDetailTab.Recipe?10:e===l.StepDetailTab.Machine?11:e===l.StepDetailTab.Recipes?12:-1)}}function Dl(t,o){if(t&1&&(c(0,$l,13,7),d(1,"asStep")),t&2){let e,n=o.$implicit;r((e=x(1,1,n))?0:-1,e)}}function Ll(t,o){t&1&&(_(0,"tr")(1,"td",22)(2,"div",58)(3,"span"),S(4),d(5,"translate"),s()()()()),t&2&&(p(4),T(x(5,1,"steps.emptyMessage")))}function Hl(t,o){if(t&1&&c(0,Ll,6,3,"tr"),t&2){let e=a();r(e.focus()?0:-1)}}function Nl(t,o){t&1&&f(0,"td",36)}function Al(t,o){t&1&&f(0,"td")}function Wl(t,o){t&1&&f(0,"td")}function Ul(t,o){if(t&1&&c(0,Al,1,0,"td")(1,Wl,1,0,"td"),t&2){let e=a(2);r(e.columnsState().checkbox.show?0:-1),p(),r(e.columnsState().tree.show?1:-1)}}function zl(t,o){if(t&1&&(f(0,"td"),c(1,Ul,2,2)),t&2){let e=a();p(),r(e.focus()?-1:1)}}function ql(t,o){t&1&&R(0)}function Jl(t,o){if(t&1&&f(0,"lab-tooltip",69),t&2){let e=a(2).itemId;u("id",e)}}function Kl(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(3).stack;p(),T(e)}}function Xl(t,o){if(t&1&&f(0,"lab-tooltip",137),t&2){let e=a(3).beltId;u("id",e)}}function Gl(t,o){if(t&1&&(_(0,"td",129)(1,"span",74),S(2),d(3,"rate"),s()(),_(4,"td",130)(5,"div",51)(6,"i",70),d(7,"iconClass"),c(8,Kl,2,1,"span")(9,Xl,1,1,"ng-template",null,6,M),s()()()),t&2){let e=h(10),n=a(2),i=n.belts,l=n.beltId,m=n.stack,C=a();p(2),T(w(3,5,i,C.columnsState().belts.precision)),p(4),O(x(7,8,l)),u("pTooltip",e),p(2),r(m!=null&&m.gt(C.rational.one)?8:-1)}}function Ql(t,o){if(t&1&&f(0,"lab-tooltip",138),t&2){let e=a(4).wagonId;u("id",e)}}function Yl(t,o){if(t&1&&(_(0,"i",70),d(1,"iconClass"),c(2,Ql,1,1,"ng-template",null,6,M),s()),t&2){let e=h(3),n=a(3).wagonId;O(x(1,3,n)),u("pTooltip",e)}}function Zl(t,o){if(t&1&&f(0,"lab-tooltip",139),t&2){let e=a(4).wagonId;u("id",e)}}function tp(t,o){if(t&1&&(_(0,"i",70),d(1,"iconClass"),c(2,Zl,1,1,"ng-template",null,6,M),s()),t&2){let e=h(3),n=a(3).wagonId;O(x(1,3,n)),u("pTooltip",e)}}function ep(t,o){if(t&1&&(_(0,"td",129)(1,"span",74),S(2),d(3,"rate"),s()(),_(4,"td",130)(5,"div",51),c(6,Yl,4,5,"i",64)(7,tp,4,5,"i",64),s()()),t&2){let e=a(2),n=e.wagons,i=e.wagonId,l=a();p(2),T(w(3,2,n,l.columnsState().wagons.precision)),p(4),r(l.data().cargoWagonIds.includes(i)?6:7)}}function np(t,o){if(t&1&&(_(0,"span",74),S(1),d(2,"machineRate"),s()),t&2){let e=a(2),n=e.machines,i=e.machineId,l=a();p(),T(gt(2,1,n,l.columnsState().machines.precision,i))}}function ip(t,o){t&1&&(_(0,"div"),S(1),d(2,"translate"),s()),t&2&&(p(),j(" ",x(2,1,"steps.inputs")," "))}function op(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(2).recipeObjectiveId;p(),j("#",e,"")}}function ap(t,o){if(t&1&&f(0,"lab-tooltip",109),t&2){let e=a(2).recipeId;u("id",e)}}function lp(t,o){if(t&1&&f(0,"lab-tooltip",94),t&2){let e=a(2).machineId;u("id",e)}}function pp(t,o){t&1&&f(0,"i",140)}function _p(t,o){t&1&&f(0,"i",140)}function sp(t,o){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(4).destRecipeObjectiveId;p(),j("#",e,"")}}function cp(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a(4),n=e.destId,i=e.destIsRecipe;u("id",n)("type",i?"recipe":"item")}}function rp(t,o){if(t&1&&(_(0,"i",70),d(1,"iconClass"),c(2,sp,2,1,"span")(3,cp,1,2,"ng-template",null,6,M),s()),t&2){let e=h(4),n=a(3),i=n.destId,l=n.destRecipeObjectiveId,m=n.destIsRecipe;O(w(1,4,i,m?"recipe":"item")),u("pTooltip",e),p(2),r(l?2:-1)}}function dp(t,o){t&1&&(_(0,"span"),S(1),d(2,"translate"),s()),t&2&&(p(),j(" ",x(2,1,"steps.outputs")," "))}function mp(t,o){if(t&1&&(c(0,pp,1,0,"i",140),_(1,"span",74),S(2),d(3,"rate"),d(4,"leftPad"),s(),c(5,_p,1,0,"i",140)(6,rp,5,7,"i",64)(7,dp,3,3,"span")),t&2){let e=a(2),n=e.percent,i=e.percentOnDest,l=e.destId,m=e.outputs;r(i?0:-1),p(2),j("",x(4,8,w(3,5,n,-2)),"%"),p(3),r(i?-1:5),p(),r(l?6:-1),p(),r(m?7:-1)}}function up(t,o){if(t&1&&(c(0,ql,1,0,"ng-container",90),_(1,"td",129)(2,"span",74),S(3),d(4,"rate"),s()(),_(5,"td",130)(6,"div",51)(7,"i",70),d(8,"iconClass"),c(9,Jl,1,1,"ng-template",null,6,M),s()()(),c(11,Gl,11,10)(12,ep,8,5),_(13,"td",129),c(14,np,3,5,"span",74),s(),_(15,"td",136)(16,"div",28),c(17,ip,3,3,"div"),_(18,"i",70),d(19,"iconClass"),c(20,op,2,1,"span")(21,ap,1,1,"ng-template",null,13,M),s(),_(23,"i",70),d(24,"iconClass"),c(25,lp,1,1,"ng-template",null,14,M),s(),c(27,mp,8,10),s()()),t&2){let e=h(10),n=h(22),i=h(26),l=a(),m=l.items,C=l.itemId,g=l.belts,y=l.beltId,b=l.wagons,V=l.wagonId,$=l.machines,D=l.machineId,A=l.recipeId,G=l.recipeObjectiveId,Ct=l.percent,Q=l.inputs,ht=a(),gn=h(9);u("ngTemplateOutlet",gn),p(3),T(w(4,17,m,ht.columnsState().items.precision)),p(4),O(x(8,20,C)),u("pTooltip",e),p(4),r(ht.columnsState().belts.show&&g&&y?11:-1),p(),r(ht.columnsState().wagons.show&&b&&V?12:-1),p(2),r($&&$.nonzero()&&!ht.data().machineEntities[D].hideRate?14:-1),p(3),r(Q?17:-1),p(),O(w(19,22,A,"recipe")),u("pTooltip",n),p(2),r(G?20:-1),p(3),O(x(24,25,D)),u("pTooltip",i),p(4),r(Ct?27:-1)}}function Cp(t,o){if(t&1&&(_(0,"tr",123),c(1,up,28,27),s()),t&2){let e=o.itemId;p(),r(e?1:-1)}}function fp(t,o){t&1&&f(0,"td")}function xp(t,o){t&1&&f(0,"td")}function gp(t,o){t&1&&R(0)}function Sp(t,o){t&1&&R(0)}function vp(t,o){t&1&&R(0)}function hp(t,o){t&1&&R(0)}function bp(t,o){if(t&1&&(_(0,"td",141)(1,"span",74),S(2),d(3,"power"),s()()),t&2){let e=a(3);p(2),T(gt(3,1,e.totals().power,e.columnsState().power.precision,e.effectivePowerUnit()))}}function Ip(t,o){if(t&1&&(_(0,"td",141)(1,"span",74),S(2),d(3,"rate"),s()()),t&2){let e=a(3);p(2),T(w(3,1,e.totals().pollution,e.columnsState().pollution.precision))}}function Tp(t,o){t&1&&f(0,"td")}function yp(t,o){if(t&1&&(_(0,"tr"),f(1,"td"),c(2,fp,1,0,"td")(3,xp,1,0,"td"),_(4,"td",36),S(5),d(6,"translate"),s(),c(7,gp,1,0,"ng-container",128)(8,Sp,1,0,"ng-container",128)(9,vp,1,0,"ng-container",128)(10,hp,1,0,"ng-container",128)(11,bp,4,5,"td",141)(12,Ip,4,4,"td",141)(13,Tp,1,0,"td"),s()),t&2){a();let e=h(2),n=a();p(2),r(n.columnsState().checkbox.show?2:-1),p(),r(n.columnsState().tree.show?3:-1),p(2),j(" ",x(6,14,"steps.total")," "),p(2),u("ngTemplateOutlet",e)("ngTemplateOutletContext",J(16,Zn,n.columnsState().belts,n.totals().belts)),p(),u("ngTemplateOutlet",e)("ngTemplateOutletContext",J(19,ti,n.columnsState().wagons,n.totals().wagons)),p(),u("ngTemplateOutlet",e)("ngTemplateOutletContext",xt(22,ei,n.columnsState().machines,n.totals().machines,n.totals().modules)),p(),u("ngTemplateOutlet",e)("ngTemplateOutletContext",xt(26,ni,n.columnsState().beacons,n.totals().beacons,n.totals().beaconModules)),p(),r(n.columnsState().power.show?11:-1),p(),r(n.columnsState().pollution.show?12:-1),p(),r(n.columnsState().link.show?13:-1)}}function wp(t,o){if(t&1&&(_(0,"div",143)(1,"span",74),S(2),d(3,"rate"),s()()),t&2){let e=o.$implicit,n=a(2).columnSettings;p(2),T(w(3,1,e.value,n.precision))}}function Ep(t,o){if(t&1&&f(0,"lab-tooltip",87),t&2){let e=a(2).$implicit,n=a(2).type;u("id",e.key)("type",n)}}function kp(t,o){if(t&1&&(_(0,"i",148),d(1,"iconClass"),c(2,Ep,1,2,"ng-template",null,6,M),s()),t&2){let e=h(3),n=a().$implicit;O(x(1,3,n.key)),u("pTooltip",e)}}function Bp(t,o){if(t&1&&f(0,"lab-tooltip",109),t&2){let e=a(2).$implicit;u("id",e.key)}}function Mp(t,o){if(t&1&&(_(0,"i",148),d(1,"iconClass"),c(2,Bp,1,1,"ng-template",null,6,M),s()),t&2){let e=h(3),n=a().$implicit;O(w(1,3,n.key,"recipe")),u("pTooltip",e)}}function Op(t,o){if(t&1&&c(0,kp,4,5,"i",147)(1,Mp,4,6,"i",147),t&2){let e=o.$implicit,n=a(4);r(n.data().itemEntities[e.key]?0:1)}}function Vp(t,o){if(t&1&&f(0,"lab-tooltip",100),t&2){let e=a().$implicit;u("id",e.key)}}function Fp(t,o){if(t&1&&(_(0,"div",149)(1,"span",74),S(2),s()(),_(3,"i",148),d(4,"iconClass"),c(5,Vp,1,1,"ng-template",null,6,M),s()),t&2){let e=o.$implicit,n=h(6);p(2),T(e.value),p(),O(w(4,4,e.key,"item")),u("pTooltip",e.key!=="module"?n:void 0)}}function Pp(t,o){if(t&1&&(_(0,"td",142),H(1,wp,4,4,"div",143,q),d(3,"keyvalue"),s(),_(4,"td",144)(5,"div",51)(6,"div",145),H(7,Op,2,1,null,null,q),d(9,"keyvalue"),s(),_(10,"div",146),H(11,Fp,7,7,null,null,q),d(13,"keyvalue"),s()()()),t&2){let e=a(),n=e.totals,i=e.modulesTotals,l=a(2);p(),N(w(3,0,n,l.trackSvc.sortByValue)),p(6),N(w(9,3,n,l.trackSvc.sortByValue)),p(4),N(w(13,6,i,l.trackSvc.sortByValue))}}function Rp(t,o){if(t&1&&c(0,Pp,14,9),t&2){let e=o.columnSettings;r(e.show?0:-1)}}function jp(t,o){if(t&1&&c(0,yp,14,30,"tr")(1,Rp,1,1,"ng-template",null,15,M),t&2){let e=a();r(e.focus()?-1:0)}}var ic=(()=>{class t{constructor(){this.document=P(Se),this.route=P(ye),this.ref=P(xe),this.contentSvc=P(Fe),this.exportSvc=P(nn),this.itemsSvc=P(Bt),this.machinesSvc=P(Pe),this.objectivesSvc=P($e),this.preferencesSvc=P(Et),this.recipeSvc=P(kt),this.recipesSvc=P(rt),this.routerSvc=P(Mt),this.settingsSvc=P(X),this.trackSvc=P(Je),this.focus=Jt(!1),this.selectedId=Jt(),this.stepsTable=ce.required("stepsTable"),this.itemsState=this.itemsSvc.settings,this.itemsModified=this.itemsSvc.itemsModified,this.machinesState=this.machinesSvc.settings,this.recipesModified=this.objectivesSvc.recipesModified,this.stepsModified=this.objectivesSvc.stepsModified,this.stepTree=this.objectivesSvc.stepTree,this.stepDetails=this.objectivesSvc.stepDetails,this.stepById=this.objectivesSvc.stepById,this.stepByItemEntities=this.objectivesSvc.stepByItemEntities,this.effectivePowerUnit=this.objectivesSvc.effectivePowerUnit,this.totals=this.objectivesSvc.totals,this.settings=this.settingsSvc.settings,this.dispRateInfo=this.settingsSvc.displayRateInfo,this.beltSpeed=this.settingsSvc.beltSpeed,this.options=this.settingsSvc.options,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset,this.preferences=this.preferencesSvc.state,this._steps=this.objectivesSvc.steps,this.steps=ge(()=>{let e=[...this._steps()];if(!this.focus())return e;let i=this.selectedId();return e.filter(l=>l.id===i)}),this.activeItemsEffect=Xt(()=>{let e=this.steps(),n=this.stepDetails();this.setActiveItems(e,n)}),this.toggleEffect=Xt(()=>{let e=this.focus(),n=this.steps()[0];e&&n&&(this.stepsTable().toggleRow(n),this.expandRow(n,!1))}),this.sortSteps$=new ne(null),this.activeItem={},this.stepDetailTab=Oe("stepDetailTab"),this.stepDetailIcon=je,this.ItemId=I,this.StepDetailTab=Re,this.ObjectiveUnit=Ve,this.rational=v,ie([this.sortSteps$.pipe(le()),Te(this._steps)]).pipe(Ie()).subscribe(([[e,n],i])=>{this.sortSteps(e,n,i)})}ngOnInit(){this.route.fragment.pipe(ae(),oe(e=>e!=null)).subscribe(e=>{this.fragmentId=e})}ngAfterViewInit(){this.loadFragmentId()}loadFragmentId(){if(this.fragmentId)try{let e=this.fragmentId,[n,i,l]=e.split("_"),m=this.steps(),C=this.stepDetails(),g=m.find(b=>b.id===i);if(g==null||!C[g.id].tabs.length)return;this.stepsTable().toggleRow(g),setTimeout(()=>{if(l){let b=this.document.querySelector(`#${e}`);b&&b.click()}else this.document.querySelector(`#${e}`)?.scrollIntoView()},10)}catch{}}sortSteps(e,n,i){if(n?.order==null||n.field==null)return;let l=n.order,m=n.field;if(e!=null&&e.field===m&&e.order!==l&&l===-1&&this.stepsTable!=null){n.data?.sort((C,g)=>i.indexOf(C)-i.indexOf(g)),this.stepsTable().sortOrder=0,this.stepsTable().sortField="",this.stepsTable().reset(),this.sortSteps$.next(null);return}n.data?.sort((C,g)=>(C[m]??v(0n)).sub(g[m]??v(0n)).toNumber()*l)}setActiveItems(e,n){e.forEach(i=>{this.updateActiveItem(i,n,!1)})}expandRow(e,n){n||this.updateActiveItem(e,this.stepDetails(),!0)}updateActiveItem(e,n,i){let l=vt.transform(e),m=this._getActiveItem(e,l,n,i);if(m){let C=vt.transform(e);this.activeItem[C]=m}}_getActiveItem(e,n,i,l){let m=this.activeItem[n],C=i[e.id];if(C==null)return null;if(m!=null){let y=C.tabs.find(b=>b.label===m.label);if(y!=null)return y}if(m==null&&!l)return null;let g=this.stepDetailTab();if(g){let y=C.tabs.find(b=>b.label===g);if(y!=null)return y}return C.tabs[0]}setActiveItem(e,n){if(n==null)return;let i=vt.transform(e);this.activeItem[i]=n,this.stepDetailTab.set(n.label)}resetStep(e){e.itemId&&this.itemsSvc.resetId(e.itemId),e.recipeObjectiveId?this.objectivesSvc.updateEntity(e.recipeObjectiveId,{machineId:void 0,fuelId:void 0,modules:void 0,beacons:void 0,overclock:void 0}):e.recipeId&&this.recipesSvc.resetId(e.recipeId)}changeItemExcluded(e,n){let i=tt(e,n,this.settings().excludedItemIds);this.settingsSvc.apply({excludedItemIds:i})}changeRecipesIncluded(e,n){let i=tt(e,!0,this.settings().excludedRecipeIds);i=tt(n,!1,i),this.settingsSvc.updateField("excludedRecipeIds",i,this.settings().defaultExcludedRecipeIds)}changeModulesBeacons(e,n){let i=e.recipeSettings;if(e.recipeId==null||i?.machineId==null)return;let l=e.recipeObjectiveId??e.recipeId,m=e.recipeObjectiveId!=null?this.objectivesSvc.updateEntity.bind(this.objectivesSvc):this.recipesSvc.updateEntity.bind(this.recipesSvc),C=this.data().machineEntities[i.machineId],g=this.machinesState()[i.machineId];n.modules&&(n.modules=this.recipeSvc.dehydrateModules(n.modules,Z(i.moduleOptions,[]),this.settings().moduleRankIds,C.modules,g.modules)),n.beacons&&(n.beacons=this.recipeSvc.dehydrateBeacons(n.beacons,g.beacons)),m(l,n)}changeBelts(e,n){e.itemId!=null&&(this.itemsSvc.updateEntityField(e.itemId,"stack",n.stack,n.defaultStack),this.itemsSvc.updateEntityField(e.itemId,"beltId",n.beltId,n.defaultBeltId))}changeStepChecked(e,n){if(e.itemId!=null){let i=tt(e.itemId,n,this.settings().checkedItemIds);this.settingsSvc.apply({checkedItemIds:i})}else if(e.recipeObjectiveId!=null){let i=tt(e.recipeObjectiveId,n,this.settings().checkedObjectiveIds);this.settingsSvc.apply({checkedObjectiveIds:i})}else if(e.recipeId!=null){let i=tt(e.recipeId,n,this.settings().checkedRecipeIds);this.settingsSvc.apply({checkedRecipeIds:i})}}resetChecked(){this.settingsSvc.apply({checkedItemIds:new Set,checkedObjectiveIds:new Set,checkedRecipeIds:new Set})}resetExcludedItems(e){this.settingsSvc.apply({excludedItemIds:new Set}),e.stopImmediatePropagation()}resetBelts(e){this.itemsSvc.resetFields("beltId"),e.stopImmediatePropagation()}resetWagons(e){this.itemsSvc.resetFields("wagonId"),e.stopImmediatePropagation()}resetMachines(e){let n=["machineId","overclock","modules","beacons"];this.objectivesSvc.resetFields(...n),this.recipesSvc.resetFields(...n),e.stopImmediatePropagation()}resetBeacons(){this.objectivesSvc.resetFields("beacons"),this.recipesSvc.resetFields("beacons")}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=et({type:t,selectors:[["lab-steps"]],viewQuery:function(n,i){n&1&&de(i.stepsTable,zn,5),n&2&&me()},inputs:{focus:[1,"focus"],selectedId:[1,"selectedId"]},standalone:!0,features:[at],decls:15,vars:10,consts:[["stepsTable",""],["emptyCol2",""],["leftPad",""],["detailRow",""],["columnsDlg",""],["recipesSelect",""],["tooltip",""],["beltPicker",""],["overclockInput",""],["modulePicker",""],["beaconsOverlay",""],["expandTabMenu",""],["machineValueCell",""],["tooltipObj",""],["tooltipMach",""],["totalCell",""],["dataKey","id","styleClass","p-datatable-sm",3,"rowsChange","sortFunction","rowTrackBy","value","customSort","rowExpandMode","defaultSortOrder","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["pTemplate","footer"],["colspan","100"],[1,"d-flex","gap-2","py-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-table-columns",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"label"],[1,"column-header-row"],["colspan","2","pSortableColumn","items"],[1,"d-flex","align-items-center"],["field","items"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"pTooltip"],["colspan","2","pSortableColumn","belts"],["colspan","2","pSortableColumn","wagons"],["colspan","2","pSortableColumn","rockets"],["colspan","2","pSortableColumn","machines"],["field","machines"],["colspan","2"],["pSortableColumn","power"],["pSortableColumn","pollution"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"click","label"],[1,"d-flex","align-items-center","justify-content-center"],[1,"fa-solid","fa-square-check"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"click","pTooltip"],["field","belts"],["field","wagons"],["field","rockets"],[1,"d-flex","align-items-center","justify-content-end"],["field","power"],["field","pollution"],[1,"w-0","px-0","px-sm-1"],[1,"fragment",3,"id"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-angle-right",1,"p-button-text","p-button-rounded","transition-ease",3,"click","pTooltip","pRowToggler"],[1,"px-0","px-sm-2"],[1,"overflow-hidden","px-0","px-sm-1","py-0"],["colspan","2",1,"px-0","px-sm-2"],[1,"px-0","px-sm-2","text-end"],[1,"w-0","px-0","ps-sm-1"],[1,"d-flex","justify-content-center"],[3,"onChange","binary","ngModel"],[1,"d-flex","align-items-center","links"],[1,"indent"],[1,"icon"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"hover-active","icon","pTooltip"],[3,"class","pTooltip"],[1,"connect",3,"trail","last"],[1,"connect"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","icon","pTooltip"],[1,"hover-icon","fa-solid","fa-eye-slash"],[3,"id"],[3,"pTooltip"],["type","recipe",3,"id","adjustedRecipe"],[1,"w-0","px-0","px-sm-2","text-end"],[1,"monospace","error-text"],[1,"monospace"],[1,"px-0","pe-sm-2"],[1,"find-text"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","pTooltip"],[1,"p-button-icon"],[1,"hover-icon","fa-solid","fa-gear"],[3,"setValue"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],[3,"id","type"],["type","pipe",3,"id"],[3,"class"],[4,"ngTemplateOutlet"],["labDropdownBase","icon",3,"pTooltip","options","ngModel"],["suffix","%","inputStyleClass","text-end",3,"min","max","step","maxFractionDigits","size","pTooltip","ngModel"],["labDropdownBase","icon",3,"onChange","pTooltip","options","ngModel"],["type","machine",3,"id"],["suffix","%","inputStyleClass","text-end",3,"onBlur","min","max","step","maxFractionDigits","size","pTooltip","ngModel"],[1,"padded",3,"pTooltip"],["type","fuel",3,"id"],["labDropdownBase","icon","labNoDrag","",3,"pTooltip","ngModel","options"],["labDropdownBase","icon","labNoDrag","",3,"onChange","pTooltip","ngModel","options"],["type","module",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","modules","p-button-text",3,"click","pTooltip"],[1,"p-button-icon",3,"class"],["inputId","enabled-recipes","styleClass","icon","appendTo","body","scrollHeight","40vh","panelStyleClass","tooltip",3,"ngModel","options","pTooltip"],["inputId","enabled-recipes","styleClass","icon","appendTo","body","scrollHeight","40vh","panelStyleClass","tooltip",3,"ngModelChange","onPanelHide","ngModel","options","pTooltip"],["pTemplate","selectedItems"],["type","recipe",3,"id","adjustedRecipe","action"],[1,"fa-solid","fa-flask-vial"],[1,"d-flex","align-items-center","p-2","w-100","h-100",3,"pTooltip"],["type","recipe",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","icons","p-button-text","flex-column",3,"click","pTooltip"],[1,"p-button-icon","sum",3,"class"],[1,"p-button-icon","sum"],["type","beacon",3,"id"],["target","_blank","routerLink",".",1,"text-decoration-none",3,"queryParams"],["pButton","","pRipple","","type","button","icon","fa-solid fa-arrow-up-right-from-square","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"click","pTooltip"],[1,"detail","tabs"],[1,"px-1"],["routerLink",".","queryParamsHandling","preserve",1,"text-decoration-none",3,"relativeTo","fragment"],["pButton","","pRipple","","type","button","icon","fa-solid fa-link",1,"p-button-text","p-button-rounded"],[3,"activeItemChange","model","activeItem"],[1,"detail"],[1,"p-menuitem-link",3,"id"],[1,"p-menuitem-icon"],[1,"p-menuitem-text"],["colspan","100",1,"fw-bold"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-0","text-end"],[1,"ps-0"],[1,"lab-icon","time"],[3,"innerHTML"],[1,"mw-0"],[1,"fa-solid","fa-arrow-right","mx-3"],["colspan","100",1,"py-4"],["colspan","100",1,"p-0"],["type","belt",3,"id"],["type","cargo-wagon",3,"id"],["type","fluid-wagon",3,"id"],[1,"m-1","p-2","fa-solid","fa-arrow-right"],[1,"text-end","inherit"],[1,"w-0","text-end","inherit"],[1,"py-2","icon-height"],[1,"ps-0","inherit"],[1,"d-flex","flex-column","justify-content-center"],[1,"modules-column"],[1,"d-block",3,"class","pTooltip"],[1,"d-block",3,"pTooltip"],[1,"p-2","icon-height","text-end"]],template:function(n,i){if(n&1){let l=F();_(0,"p-table",16,0),B("rowsChange",function(C){return E(l),k(i.preferencesSvc.apply({rows:C}))})("sortFunction",function(C){return E(l),k(i.sortSteps$.next(C))}),c(2,wi,31,23,"ng-template",17)(3,va,2,3,"ng-template",18)(4,Dl,2,3,"ng-template",19)(5,Hl,1,1,"ng-template",20)(6,Nl,1,0,"ng-template",null,1,M)(8,zl,2,1,"ng-template",null,2,M)(10,Cp,2,1,"ng-template",null,3,M)(12,jp,3,1,"ng-template",21),s(),f(13,"lab-columns",null,4)}n&2&&u("rowTrackBy",i.trackSvc.trackStep)("value",i.steps())("customSort",!0)("rowExpandMode",i.focus()?"single":"multiple")("defaultSortOrder",-1)("paginator",!i.focus()&&!i.preferences().disablePaginator)("rows",i.preferences().rows)("rowsPerPageOptions",Y(9,qn))("showCurrentPageReport",!0)},dependencies:[he,ut,dt,mt,be,ve,we,st,_t,pt,jt,Rt,Pt,Ft,Nt,Ht,Xe,Ke,Wt,At,Ge,Ye,Qe,ze,Ue,Ot,Vt,on,Ze,un,Cn,$t,Le,Dt,ln,pn,_n,tn,qe,sn,z,cn,vt,Lt,ct],styles:[".links[_ngcontent-%COMP%]{height:50px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{position:relative;margin-left:16px;height:100vh}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%], .links[_ngcontent-%COMP%]   .connect.trail[_ngcontent-%COMP%]{border-left:2px dotted var(--text-color-secondary)}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%]:not(.trail){margin-bottom:50vh;height:50vh}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:24px}@media (max-width: 1199.98px){.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{margin-left:8px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:16px}}.links[_ngcontent-%COMP%]   .indent[_ngcontent-%COMP%]{margin-left:0;border-top:2px dotted var(--text-color-secondary);width:8px}.links[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px}[_nghost-%COMP%]     .p-dropdown:not(:is(:hover,  :focus,  .ng-invalid)), [_nghost-%COMP%]     .p-inputtext:not(:is(:hover,  :focus,  .ng-invalid)), [_nghost-%COMP%]     .p-multiselect:not(:is(:hover,  :focus,  .ng-invalid)){border-color:transparent;background-color:transparent}tr.detail[_ngcontent-%COMP%]{background-color:var(--surface-ground)}tr.detail.tabs[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-bottom-color:transparent}[_nghost-%COMP%]     tr.detail .p-tabmenu .p-tabmenu-nav .p-tabmenuitem:not(.p-highlight) .p-menuitem-link{background-color:transparent}.icon-height[_ngcontent-%COMP%]{min-height:32px}.modules-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;margin:auto}.fragment[_ngcontent-%COMP%]{position:absolute;top:-10rem;visibility:hidden}.column-header-row[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{height:48px}"],changeDetection:0})}}return t})();export{en as a,nn as b,ic as c};
