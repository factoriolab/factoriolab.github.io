import{$c as l,Ec as I,Gd as g,Ib as m,Id as S,Kc as d,Kd as f,O as p,Rc as h,S as a,ba as u}from"./chunk-R4G6OKCB.js";var b=(()=>{class i extends l{constructor(){super(...arguments),this.settingsSvc=a(f),this.settings=m(()=>this.computeItemsSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=m(()=>{let s=this.state();return{belts:Object.keys(s).some(t=>s[t].beltId!=null),wagons:Object.keys(s).some(t=>s[t].wagonId!=null)}})}computeItemsSettings(s,t,o){let r={};for(let n of o.itemIds.map(c=>o.itemEntities[c])){let c=s[n.id],e=this.defaultBelt(n,t),v=this.defaultWagon(n,t),j=d(c?.beltId,e),F=d(c?.wagonId,v),O=d(c?.stack,t.stack);r[n.id]={beltId:j,defaultBeltId:e,wagonId:F,defaultWagonId:v,stack:O}}return r}defaultBelt(s,t){return s.stack?t.beltId:t.pipeId?t.pipeId:I.Pipe}defaultWagon(s,t){return s.stack?t.cargoWagonId:t.fluidWagonId}static{this.\u0275fac=(()=>{let s;return function(o){return(s||(s=u(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var k=(()=>{class i extends l{constructor(){super(...arguments),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeMachinesSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}computeMachinesSettings(s,t,o){let r={};for(let n of o.machineIds){let c=o.machineEntities[n],e=h(s[n]);c.type===g.Burner?(e.fuelOptions=this.recipeSvc.fuelOptions(c,t,o),e.defaultFuelId=this.recipeSvc.bestMatch(e.fuelOptions,t.fuelRankIds),e.fuelId=d(e?.fuelId,e.defaultFuelId)):delete e.fuelId,c.modules?(e.moduleOptions=this.recipeSvc.moduleOptions(c,t,o),e.modules=this.recipeSvc.hydrateModules(e.modules,e.moduleOptions,t.moduleRankIds,c.modules),e.beacons=this.recipeSvc.hydrateBeacons(e.beacons,t.beacons)):(delete e.modules,delete e.beacons),e.defaultOverclock=t.overclock,e.overclock=d(e.overclock,e.defaultOverclock),r[n]=e}return r}static{this.\u0275fac=(()=>{let s;return function(o){return(s||(s=u(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var X=(()=>{class i extends l{constructor(){super(...arguments),this.itemsSvc=a(b),this.machinesSvc=a(k),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeRecipesSettings(this.state(),this.machinesSvc.settings(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=m(()=>{let s=this.settings(),t=this.itemsSvc.settings(),o=this.settingsSvc.settings(),r=this.settingsSvc.dataset();return this.recipeSvc.adjustDataset(s,t,o,r)})}computeRecipesSettings(s,t,o,r){let n={};for(let c of r.recipeIds.map(e=>r.recipeEntities[e])){let e=h(s[c.id]);this.recipeSvc.computeRecipeSettings(e,c,t,o,r),n[c.id]=e}return n}static{this.\u0275fac=(()=>{let s;return function(o){return(s||(s=u(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{b as a,k as b,X as c};
