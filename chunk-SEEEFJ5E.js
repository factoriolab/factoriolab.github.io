import{Hc as g,Jd as k,Lb as m,Ld as S,Nc as l,Nd as f,O as d,S as a,Uc as h,ba as u,cd as p}from"./chunk-XHKWIPKI.js";var b=(()=>{class i extends p{constructor(){super(...arguments),this.settingsSvc=a(f),this.settings=m(()=>this.computeItemsSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=m(()=>{let s=this.state();return{belts:Object.keys(s).some(t=>s[t].beltId!=null),wagons:Object.keys(s).some(t=>s[t].wagonId!=null)}})}computeItemsSettings(s,t,c){let n={};for(let r of c.itemIds.map(o=>c.itemEntities[o])){let o=s[r.id],e=this.defaultBelt(r,t),I=this.defaultWagon(r,t),F=l(o?.beltId,e),O=l(o?.wagonId,I),v=o?.stack;v==null&&r.stack&&t.stack&&(v=r.stack.lt(t.stack)?r.stack:t.stack),n[r.id]={beltId:F,defaultBeltId:e,wagonId:O,defaultWagonId:I,stack:v}}return n}defaultBelt(s,t){return s.stack?t.beltId:t.pipeId?t.pipeId:g.Pipe}defaultWagon(s,t){return s.stack?t.cargoWagonId:t.fluidWagonId}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=u(i)))(c||i)}})()}static{this.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var j=(()=>{class i extends p{constructor(){super(...arguments),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeMachinesSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}computeMachinesSettings(s,t,c){let n={};for(let r of c.machineIds){let o=c.machineEntities[r],e=h(s[r]);o.type===k.Burner?(e.fuelOptions=this.recipeSvc.fuelOptions(o,t,c),e.defaultFuelId=this.recipeSvc.bestMatch(e.fuelOptions,t.fuelRankIds),e.fuelId=l(e?.fuelId,e.defaultFuelId)):delete e.fuelId,o.modules?(e.moduleOptions=this.recipeSvc.moduleOptions(o,t,c),e.modules=this.recipeSvc.hydrateModules(e.modules,e.moduleOptions,t.moduleRankIds,o.modules),e.beacons=this.recipeSvc.hydrateBeacons(e.beacons,t.beacons)):(delete e.modules,delete e.beacons),e.defaultOverclock=t.overclock,e.overclock=l(e.overclock,e.defaultOverclock),n[r]=e}return n}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=u(i)))(c||i)}})()}static{this.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var X=(()=>{class i extends p{constructor(){super(...arguments),this.itemsSvc=a(b),this.machinesSvc=a(j),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeRecipesSettings(this.state(),this.machinesSvc.settings(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=m(()=>{let s=this.settings(),t=this.itemsSvc.settings(),c=this.settingsSvc.settings(),n=this.settingsSvc.dataset();return this.recipeSvc.adjustDataset(s,t,c,n)})}computeRecipesSettings(s,t,c,n){let r={};for(let o of n.recipeIds.map(e=>n.recipeEntities[e])){let e=h(s[o.id]);this.recipeSvc.computeRecipeSettings(e,o,t,c,n),r[o.id]=e}return r}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=u(i)))(c||i)}})()}static{this.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{b as a,j as b,X as c};
