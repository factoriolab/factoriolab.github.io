import{$c as u,Ec as I,Gd as g,Ib as m,Id as S,Kc as d,Kd as f,O as p,Rc as v,S as a,ba as l}from"./chunk-24SO65ZK.js";var b=(()=>{class i extends u{constructor(){super(...arguments),this.settingsSvc=a(f),this.settings=m(()=>this.computeItemsSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=m(()=>{let t=this.state();return{belts:Object.keys(t).some(e=>t[e].beltId!=null),wagons:Object.keys(t).some(e=>t[e].wagonId!=null)}})}computeItemsSettings(t,e,c){let n={};for(let r of c.itemIds.map(o=>c.itemEntities[o])){let o=t[r.id],s=this.defaultBelt(r,e),h=this.defaultWagon(r,e),j=d(o?.beltId,s),F=d(o?.wagonId,h),O=d(o?.stack,e.stack);n[r.id]={beltId:j,defaultBeltId:s,wagonId:F,defaultWagonId:h,stack:O}}return n}defaultBelt(t,e){return t.stack?e.beltId:e.pipeId?e.pipeId:I.Pipe}defaultWagon(t,e){return t.stack?e.cargoWagonId:e.fluidWagonId}static{this.\u0275fac=(()=>{let t;return function(c){return(t||(t=l(i)))(c||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var k=(()=>{class i extends u{constructor(){super(...arguments),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeMachinesSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}computeMachinesSettings(t,e,c){let n={};for(let r of c.machineIds){let o=c.machineEntities[r],s=v(t[r]);o.type===g.Burner?(s.fuelOptions=this.recipeSvc.fuelOptions(o,c),s.defaultFuelId=this.recipeSvc.bestMatch(s.fuelOptions.map(h=>h.value),e.fuelRankIds),s.fuelId=d(s?.fuelId,s.defaultFuelId)):delete s.fuelId,o.modules?(s.moduleOptions=this.recipeSvc.moduleOptions(o,c),s.modules=this.recipeSvc.hydrateModules(s.modules,s.moduleOptions,e.moduleRankIds,o.modules),s.beacons=this.recipeSvc.hydrateBeacons(s.beacons,e.beacons)):(delete s.modules,delete s.beacons),s.defaultOverclock=e.overclock,s.overclock=d(s.overclock,s.defaultOverclock),n[r]=s}return n}static{this.\u0275fac=(()=>{let t;return function(c){return(t||(t=l(i)))(c||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var X=(()=>{class i extends u{constructor(){super(...arguments),this.itemsSvc=a(b),this.machinesSvc=a(k),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=m(()=>this.computeRecipesSettings(this.state(),this.machinesSvc.settings(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=m(()=>{let t=this.settings(),e=this.itemsSvc.settings(),c=this.settingsSvc.availableRecipeIds(),n=this.settingsSvc.settings(),r=this.settingsSvc.dataset();return this.recipeSvc.adjustDataset(c,t,e,n,r)}),this.availableItemIds=m(()=>{let t=this.adjustedDataset();return t.itemIds.filter(e=>t.itemRecipeIds[e].length)})}computeRecipesSettings(t,e,c,n){let r={};for(let o of n.recipeIds.map(s=>n.recipeEntities[s])){let s=v(t[o.id]);this.recipeSvc.computeRecipeSettings(s,o,e,c,n),r[o.id]=s}return r}static{this.\u0275fac=(()=>{let t;return function(c){return(t||(t=l(i)))(c||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{b as a,k as b,X as c};
