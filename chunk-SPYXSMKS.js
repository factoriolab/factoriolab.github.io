import{Hc as g,Jc as k,Jd as y,Lb as u,Ld as S,Nc as m,Nd as f,O as l,S as a,Uc as h,ba as d,cd as p}from"./chunk-JTSXESBC.js";var j=(()=>{class i extends p{constructor(){super(...arguments),this.settingsSvc=a(f),this.settings=u(()=>this.computeItemsSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=u(()=>{let e=this.state();return{belts:Object.keys(e).some(t=>e[t].beltId!=null),wagons:Object.keys(e).some(t=>e[t].wagonId!=null)}})}computeItemsSettings(e,t,c){let n={};for(let r of c.itemIds.map(o=>c.itemEntities[o])){let o=e[r.id],s=this.defaultBelt(r,t),v=this.defaultStack(r,t),I=this.defaultWagon(r,t),O=m(o?.beltId,s),B=m(o?.stack,v),E=m(o?.wagonId,I);n[r.id]={beltId:O,defaultBeltId:s,stack:B,defaultStack:v,wagonId:E,defaultWagonId:I}}return n}defaultBelt(e,t){return e.stack?t.beltId:t.pipeId?t.pipeId:g.Pipe}defaultStack(e,t){return e.stack==null||t.stack==null?k.one:e.stack.lt(t.stack)?e.stack:t.stack}defaultWagon(e,t){return e.stack?t.cargoWagonId:t.fluidWagonId}static{this.\u0275fac=(()=>{let e;return function(c){return(e||(e=d(i)))(c||i)}})()}static{this.\u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var F=(()=>{class i extends p{constructor(){super(...arguments),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=u(()=>this.computeMachinesSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}computeMachinesSettings(e,t,c){let n={};for(let r of c.machineIds){let o=c.machineEntities[r],s=h(e[r]);o.type===y.Burner?(s.fuelOptions=this.recipeSvc.fuelOptions(o,t,c),s.defaultFuelId=this.recipeSvc.bestMatch(s.fuelOptions,t.fuelRankIds),s.fuelId=m(s?.fuelId,s.defaultFuelId)):delete s.fuelId,o.modules?(s.moduleOptions=this.recipeSvc.moduleOptions(o,t,c),s.modules=this.recipeSvc.hydrateModules(s.modules,s.moduleOptions,t.moduleRankIds,o.modules),s.beacons=this.recipeSvc.hydrateBeacons(s.beacons,t.beacons)):(delete s.modules,delete s.beacons),s.defaultOverclock=t.overclock,s.overclock=m(s.overclock,s.defaultOverclock),n[r]=s}return n}static{this.\u0275fac=(()=>{let e;return function(c){return(e||(e=d(i)))(c||i)}})()}static{this.\u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var $=(()=>{class i extends p{constructor(){super(...arguments),this.itemsSvc=a(j),this.machinesSvc=a(F),this.recipeSvc=a(S),this.settingsSvc=a(f),this.settings=u(()=>this.computeRecipesSettings(this.state(),this.machinesSvc.settings(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=u(()=>{let e=this.settings(),t=this.itemsSvc.settings(),c=this.settingsSvc.settings(),n=this.settingsSvc.dataset();return this.recipeSvc.adjustDataset(e,t,c,n)})}computeRecipesSettings(e,t,c,n){let r={};for(let o of n.recipeIds.map(s=>n.recipeEntities[s])){let s=h(e[o.id]);this.recipeSvc.computeRecipeSettings(s,o,t,c,n),r[o.id]=s}return r}static{this.\u0275fac=(()=>{let e;return function(c){return(e||(e=d(i)))(c||i)}})()}static{this.\u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{j as a,F as b,$ as c};
