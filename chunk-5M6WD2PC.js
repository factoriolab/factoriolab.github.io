import{a as me}from"./chunk-SRDARN3U.js";import{c as de,d as _e,f as fe,g as be}from"./chunk-PEMRWV4Z.js";import{b as pt}from"./chunk-GBQKOD32.js";import{b as ue}from"./chunk-UXOKLNOV.js";import{f as K,g as ce,h as Se}from"./chunk-VD6QZMID.js";import{e as le,f as se,h as pe,i as U,j as R,m as Me}from"./chunk-4SAFWG2G.js";import{B as re,a as rt,n as z,o as ke,q as x,w as at,x as lt,y as j,z as W}from"./chunk-APXPO2UW.js";import{$ as b,$a as k,Aa as Re,Ab as E,Ba as d,Da as L,Ea as s,Ec as $,Fb as Ue,Fd as st,Gb as Ce,Gc as C,Hd as ae,Ia as T,Ib as J,Ja as w,Ka as Ae,Kb as Ie,Kc as V,Ma as te,Na as ie,O as Ee,Oa as c,P as Ve,Pa as m,Pb as Ke,Pc as oe,Qa as v,Qb as Ze,Ra as ye,Rb as Ge,Rc as F,S as D,Sa as xe,T as O,Ta as He,U as Fe,Ua as g,Ub as Je,V as X,Va as u,Vb as Xe,W as De,Wa as a,Yb as Ye,Z as Oe,Za as Ne,Zb as Te,_ as f,_a as P,ab as S,ba as Y,db as M,ea as N,eb as B,ec as et,fb as G,fc as tt,gb as ne,ha as Le,hc as it,ia as Q,ic as nt,jc as ot,ka as Pe,ma as ge,mb as q,na as $e,nb as Qe,ob as qe,pb as ze,pc as we,qa as p,qb as je,ra as Z,v as Be,wb as h,xa as I,xb as y,za as ee,zb as We}from"./chunk-H7JAMPKO.js";var dt=["content"],_t=["navbar"],ft=["inkbar"],bt=["prevBtn"],vt=["nextBtn"],ht=["tabLink"],gt=["tab"],yt=i=>({"p-tabmenu p-component":!0,"p-tabmenu-scrollable":i}),xt=(i,l,e)=>({"p-tabmenuitem":!0,"p-disabled":i,"p-highlight":l,"p-hidden":e}),Ct=(i,l)=>({$implicit:i,index:l}),It=()=>({exact:!1});function Tt(i,l){i&1&&v(0,"ChevronLeftIcon"),i&2&&L("aria-hidden",!0)}function wt(i,l){}function kt(i,l){i&1&&d(0,wt,0,0,"ng-template")}function St(i,l){if(i&1){let e=g();c(0,"button",17,3),u("click",function(){f(e);let n=a();return b(n.navBackward())}),d(2,Tt,1,1,"ChevronLeftIcon",18)(3,kt,1,0,null,19),m()}if(i&2){let e=a();p(2),s("ngIf",!e.previousIconTemplate),p(),s("ngTemplateOutlet",e.previousIconTemplate)}}function Mt(i,l){if(i&1&&v(0,"span",28),i&2){let e=a(2).$implicit;s("ngClass",e.icon)("ngStyle",e.iconStyle)}}function Bt(i,l){if(i&1&&(c(0,"span",29),B(1),m()),i&2){let e=a(2).$implicit,t=a();p(),G(t.getItemProp(e,"label"))}}function Et(i,l){if(i&1&&v(0,"span",30),i&2){let e=a(2).$implicit,t=a();s("innerHTML",t.getItemProp(e,"label"),ge)}}function Vt(i,l){if(i&1&&(c(0,"span",31),B(1),m()),i&2){let e=a(2).$implicit,t=a();s("ngClass",e.badgeStyleClass),p(),G(t.getItemProp(e,"badge"))}}function Ft(i,l){if(i&1&&(c(0,"a",24,5),ye(2),d(3,Mt,1,2,"span",25)(4,Bt,2,1,"span",26)(5,Et,1,1,"ng-template",null,6,E)(7,Vt,2,2,"span",27),xe(),m()),i&2){let e=M(6),t=a().$implicit,n=a();s("target",n.getItemProp(t,"target")),L("href",n.getItemProp(t,"url"),$e)("id",n.getItemProp(t,"id"))("aria-disabled",n.disabled(t))("aria-label",n.getItemProp(t,"label"))("tabindex",n.disabled(t)?-1:0),p(3),s("ngIf",t.icon),p(),s("ngIf",t.escape!==!1)("ngIfElse",e),p(3),s("ngIf",t.badge)}}function Dt(i,l){if(i&1&&v(0,"span",28),i&2){let e=a(2).$implicit;s("ngClass",e.icon)("ngStyle",e.iconStyle),L("aria-hidden",!0)}}function Ot(i,l){if(i&1&&(c(0,"span",29),B(1),m()),i&2){let e=a(2).$implicit,t=a();p(),G(t.getItemProp(e,"label"))}}function Lt(i,l){if(i&1&&v(0,"span",30),i&2){let e=a(2).$implicit,t=a();s("innerHTML",t.getItemProp(e,"label"),ge)}}function Pt(i,l){if(i&1&&(c(0,"span",31),B(1),m()),i&2){let e=a(2).$implicit,t=a();s("ngClass",e.badgeStyleClass),p(),G(t.getItemProp(e,"badge"))}}function $t(i,l){if(i&1&&(c(0,"a",32,5),ye(2),d(3,Dt,1,3,"span",25)(4,Ot,2,1,"span",26)(5,Lt,1,1,"ng-template",null,7,E)(7,Pt,2,2,"span",27),xe(),m()),i&2){let e=M(6),t=a().$implicit,n=a();s("routerLink",t.routerLink)("queryParams",t.queryParams)("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",t.routerLinkActiveOptions||Qe(19,It))("target",t.target)("fragment",t.fragment)("queryParamsHandling",t.queryParamsHandling)("preserveFragment",t.preserveFragment)("skipLocationChange",t.skipLocationChange)("replaceUrl",t.replaceUrl)("state",t.state),L("id",n.getItemProp(t,"id"))("aria-disabled",n.disabled(t))("aria-label",n.getItemProp(t,"label"))("tabindex",n.disabled(t)?-1:0),p(3),s("ngIf",t.icon),p(),s("ngIf",t.escape!==!1)("ngIfElse",e),p(3),s("ngIf",t.badge)}}function Rt(i,l){i&1&&He(0)}function At(i,l){if(i&1){let e=g();c(0,"li",20,4),u("click",function(n){let o=f(e).$implicit,r=a();return b(r.itemClick(n,o))})("keydown",function(n){let o=f(e),r=o.$implicit,_=o.index,H=a();return b(H.onKeydownItem(n,_,r))})("focus",function(){let n=f(e).$implicit,o=a();return b(o.onMenuItemFocus(n))}),d(2,Ft,8,10,"a",21)(3,$t,8,20,"a",22)(4,Rt,1,0,"ng-container",23),m()}if(i&2){let e=l.$implicit,t=l.index,n=a();T(e.styleClass),s("ngStyle",e.style)("ngClass",je(11,xt,n.getItemProp(e,"disabled"),n.isActive(e),e.visible===!1))("tooltipOptions",e.tooltipOptions),L("data-p-disabled",n.disabled(e))("data-p-highlight",n.focusedItemInfo()===e),p(2),s("ngIf",!e.routerLink&&!n.itemTemplate),p(),s("ngIf",e.routerLink&&!n.itemTemplate),p(),s("ngTemplateOutlet",n.itemTemplate)("ngTemplateOutletContext",ze(15,Ct,e,t))}}function Ht(i,l){i&1&&v(0,"ChevronRightIcon"),i&2&&L("aria-hidden",!0)}function Nt(i,l){}function Qt(i,l){i&1&&d(0,Nt,0,0,"ng-template")}function qt(i,l){if(i&1){let e=g();c(0,"button",33,8),u("click",function(){f(e);let n=a();return b(n.navForward())}),d(2,Ht,1,1,"ChevronRightIcon",18)(3,Qt,1,0,null,19),m()}if(i&2){let e=a();p(2),s("ngIf",!e.previousIconTemplate),p(),s("ngTemplateOutlet",e.nextIconTemplate)}}var Li=(()=>{class i{platformId;router;route;cd;set model(e){this._model=e,this._focusableItems=(this._model||[]).reduce((t,n)=>(t.push(n),t),[])}get model(){return this._model}set activeItem(e){this._activeItem=e,this.activeItemChange.emit(e),this.tabChanged=!0}get activeItem(){return this._activeItem}scrollable;popup;style;styleClass;ariaLabel;ariaLabelledBy;activeItemChange=new N;content;navbar;inkbar;prevBtn;nextBtn;tabLink;tab;templates;itemTemplate;previousIconTemplate;nextIconTemplate;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;timerIdForAutoScroll=null;_focusableItems;_model;_activeItem;focusedItemInfo=I(null);get focusableItems(){return(!this._focusableItems||!this._focusableItems.length)&&(this._focusableItems=(this.model||[]).reduce((e,t)=>(e.push(t),e),[])),this._focusableItems}constructor(e,t,n,o){this.platformId=e,this.router=t,this.route=n,this.cd=o,this.router.events.pipe(Be(r=>r instanceof et)).subscribe(r=>{this.cd.markForCheck()})}ngOnChanges(e){e.activeItem&&this.autoScrollForActiveItem()}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"nexticon":this.nextIconTemplate=e.template;break;case"previousicon":this.previousIconTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}ngAfterViewInit(){Te(this.platformId)&&(this.updateInkBar(),this.autoScrollForActiveItem(),this.initButtonState())}ngAfterViewChecked(){Te(this.platformId)&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.clearAutoScrollHandler()}isActive(e){if(e.routerLink){let t=Array.isArray(e.routerLink)?e.routerLink:[e.routerLink];return this.router.isActive(this.router.createUrlTree(t,{relativeTo:this.route}).toString(),e.routerLinkActiveOptions?.exact??e.routerLinkActiveOptions??!1)}return e===this.activeItem}getItemProp(e,t){return e?rt.getItemValue(e[t]):void 0}visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1}disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled}onMenuItemFocus(e){this.focusedItemInfo.set(e)}itemClick(e,t){if(t.disabled){e.preventDefault();return}!t.url&&!t.routerLink&&e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),this.activeItem=t,this.tabChanged=!0,this.cd.markForCheck()}onKeydownItem(e,t,n){let o=t,r={},_=this.tabLink.toArray(),H=this.tab.toArray();switch(e.code){case"ArrowRight":r=this.findNextItem(H,o),o=r.i;break;case"ArrowLeft":r=this.findPrevItem(H,o),o=r.i;break;case"End":r=this.findPrevItem(H,this.model.length),o=r.i,e.preventDefault();break;case"Home":r=this.findNextItem(H,-1),o=r.i,e.preventDefault();break;case"Space":case"Enter":this.itemClick(e,n);break;case"Tab":this.onTabKeyDown(_);break;default:break}_[o]&&_[t]&&(_[t].nativeElement.tabIndex="-1",_[o].nativeElement.tabIndex="0",_[o].nativeElement.focus()),this.cd.markForCheck()}onTabKeyDown(e){e.forEach(t=>{t.nativeElement.tabIndex=x.getAttribute(t.nativeElement.parentElement,"data-p-highlight")?"0":"-1"})}findNextItem(e,t){let n=t+1;if(n>=e.length)return{nextItem:e[e.length],i:e.length};let o=e[n];return o?x.getAttribute(o.nativeElement,"data-p-disabled")?this.findNextItem(e,n):{nextItem:o.nativeElement,i:n}:null}findPrevItem(e,t){let n=t-1;if(n<0)return{prevItem:e[0],i:0};let o=e[n];return o?x.getAttribute(o.nativeElement,"data-p-disabled")?this.findPrevItem(e,n):{prevItem:o.nativeElement,i:n}:null}updateInkBar(){let e=x.findSingle(this.navbar?.nativeElement,"li.p-highlight");e&&(this.inkbar.nativeElement.style.width=x.getWidth(e)+"px",this.inkbar.nativeElement.style.left=x.getOffset(e).left-x.getOffset(this.navbar?.nativeElement).left+"px")}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((e,t)=>t?e+x.getWidth(t):e,0)}updateButtonState(){let e=this.content?.nativeElement,{scrollLeft:t,scrollWidth:n}=e,o=x.getWidth(e);this.backwardIsDisabled=t===0,this.forwardIsDisabled=parseInt(t)===n-o}updateScrollBar(e){let t=this.navbar?.nativeElement.children[e];t&&t&&typeof t.scrollIntoView=="function"&&t.scrollIntoView({block:"nearest",inline:"center"})}onScroll(e){this.scrollable&&this.updateButtonState(),e.preventDefault()}navBackward(){let e=this.content?.nativeElement,t=x.getWidth(e)-this.getVisibleButtonWidths(),n=e.scrollLeft-t;e.scrollLeft=n<=0?0:n}navForward(){let e=this.content?.nativeElement,t=x.getWidth(e)-this.getVisibleButtonWidths(),n=e.scrollLeft+t,o=e.scrollWidth-t;e.scrollLeft=n>=o?o:n}autoScrollForActiveItem(){this.scrollable&&(this.clearAutoScrollHandler(),this.timerIdForAutoScroll=setTimeout(()=>{let e=this.model.findIndex(t=>this.isActive(t));e!==-1&&this.updateScrollBar(e)}))}clearAutoScrollHandler(){this.timerIdForAutoScroll&&(clearTimeout(this.timerIdForAutoScroll),this.timerIdForAutoScroll=null)}initButtonState(){this.scrollable&&Promise.resolve().then(()=>{this.updateButtonState(),this.cd.markForCheck()})}static \u0275fac=function(t){return new(t||i)(Z(Pe),Z(it),Z(tt),Z(Ue))};static \u0275cmp=O({type:i,selectors:[["p-tabMenu"]],contentQueries:function(t,n,o){if(t&1&&Ne(o,z,4),t&2){let r;k(r=S())&&(n.templates=r)}},viewQuery:function(t,n){if(t&1&&(P(dt,5),P(_t,5),P(ft,5),P(bt,5),P(vt,5),P(ht,5),P(gt,5)),t&2){let o;k(o=S())&&(n.content=o.first),k(o=S())&&(n.navbar=o.first),k(o=S())&&(n.inkbar=o.first),k(o=S())&&(n.prevBtn=o.first),k(o=S())&&(n.nextBtn=o.first),k(o=S())&&(n.tabLink=o),k(o=S())&&(n.tab=o)}},hostAttrs:[1,"p-element"],inputs:{model:"model",activeItem:"activeItem",scrollable:[2,"scrollable","scrollable",Ce],popup:[2,"popup","popup",Ce],style:"style",styleClass:"styleClass",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{activeItemChange:"activeItemChange"},features:[Re,Oe],decls:11,vars:11,consts:[["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["tab",""],["tabLink",""],["htmlLabel",""],["htmlRouteLabel",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabmenu-nav-container"],["class","p-tabmenu-nav-prev p-tabmenu-nav-btn p-link","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],[1,"p-tabmenu-nav-content",3,"scroll"],["role","menubar",1,"p-tabmenu-nav","p-reset"],["role","presentation","pTooltip","",3,"ngStyle","class","ngClass","tooltipOptions","click","keydown","focus",4,"ngFor","ngForOf"],["role","none",1,"p-tabmenu-ink-bar"],["class","p-tabmenu-nav-next p-tabmenu-nav-btn p-link","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-prev","p-tabmenu-nav-btn","p-link",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation","pTooltip","",3,"click","keydown","focus","ngStyle","ngClass","tooltipOptions"],["class","p-menuitem-link","role","menuitem","pRipple","",3,"target",4,"ngIf"],["role","menuitem","class","p-menuitem-link","pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","menuitem","pRipple","",1,"p-menuitem-link",3,"target"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[1,"p-menuitem-badge",3,"ngClass"],["role","menuitem","pRipple","",1,"p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-next","p-tabmenu-nav-btn","p-link",3,"click"]],template:function(t,n){if(t&1){let o=g();c(0,"div",9)(1,"div",10),d(2,St,4,2,"button",11),c(3,"div",12,0),u("scroll",function(_){return f(o),b(n.onScroll(_))}),c(5,"ul",13,1),d(7,At,5,18,"li",14),v(8,"li",15,2),m()(),d(10,qt,4,2,"button",16),m()()}t&2&&(T(n.styleClass),s("ngClass",qe(9,yt,n.scrollable))("ngStyle",n.style),p(2),s("ngIf",n.scrollable&&!n.backwardIsDisabled),p(3),L("aria-labelledby",n.ariaLabelledBy)("aria-label",n.ariaLabel),p(2),s("ngForOf",n.focusableItems),p(3),s("ngIf",n.scrollable&&!n.forwardIsDisabled))},dependencies:()=>[Ke,Ze,Ge,Xe,Je,nt,ot,at,U,Se,Me],styles:[`@layer primeng{.p-tabmenu-nav-container{position:relative}.p-tabmenu-scrollable .p-tabmenu-nav-container{overflow:hidden}.p-tabmenu-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabmenu-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabmenu-nav-prev{left:0}.p-tabmenu-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabmenu-nav{display:flex;margin:0;padding:0;list-style-type:none;flex-wrap:nowrap}.p-tabmenu-nav a{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabmenu-nav a:focus{z-index:1}.p-tabmenu-nav .p-menuitem-text{line-height:1;white-space:nowrap}.p-tabmenu-ink-bar{display:none;z-index:1}.p-tabmenu-nav-content::-webkit-scrollbar{display:none}.p-tabmenuitem:not(.p-hidden){display:flex}}
`],encapsulation:2,changeDetection:0})}return i})(),Pi=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=Fe({type:i});static \u0275inj=Ve({imports:[Ye,we,ke,lt,R,Se,Me,we,ke,R]})}return i})();var Ri=(()=>{class i{onMousedown(e){e.stopPropagation()}onTouchStart(e){e.stopPropagation()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=X({type:i,selectors:[["","labNoDrag",""]],hostBindings:function(t,n){t&1&&u("mousedown",function(r){return n.onMousedown(r)})("touchstart",function(r){return n.onTouchStart(r)})},standalone:!0})}}return i})();var Ni=(()=>{class i{trackStep(e,t){return`${V(t.itemId,"")}|${V(t.recipeId,"")}`}trackById(e,t){return t.id}sortByValue(e,t){return t.value.sub(e.value).toNumber()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ve=(()=>{class i{constructor(){this.contentSvc=D(pt),this.pDropdown=D(K,{self:!0}),this.labDropdownBase=Q(),this.setAutoFocusFilter=Ie(()=>{let e=this.contentSvc.isMobile();this.pDropdown.autofocusFilter=!e}),this.setStyleClass=Ie(()=>{this.pDropdown.styleClass=this.labDropdownBase()})}ngOnInit(){this.pDropdown.appendTo="body",this.pDropdown.filter=!0,this.pDropdown.scrollHeight="40vh",this.pDropdown.panelStyleClass="tooltip"}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=X({type:i,selectors:[["","labDropdownBase",""]],inputs:{labDropdownBase:[1,"labDropdownBase"]},standalone:!0})}}return i})();var mt=(()=>{class i{transform(e,t,n){if(e==null)return[];if(!t?.length)return e;let o=new Set(t);return e.filter(r=>!o.has(r.value)||r.value===n)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=De({name:"filterOptions",type:i,pure:!0,standalone:!0})}}return i})();var Ut=(i,l)=>l.id;function Kt(i,l){if(i&1&&(c(0,"div",8),v(1,"i"),h(2,"iconSmClass"),m()),i&2){let e=l.$implicit;p(),T(y(2,2,e.value))}}function Zt(i,l){if(i&1&&v(0,"lab-tooltip",11),i&2){let e=a().$implicit;s("id",e.value)}}function Gt(i,l){if(i&1&&(c(0,"div",9),v(1,"i"),h(2,"iconSmClass"),c(3,"div",10),B(4),m(),d(5,Zt,1,1,"ng-template",null,0,E),m()),i&2){let e=l.$implicit,t=M(6);s("pTooltip",e.value!=="module"?t:void 0),p(),T(y(2,4,e.value)),p(3),ne(" ",e.label," ")}}function Jt(i,l){if(i&1&&v(0,"lab-tooltip",11),i&2){let e=a(2).$implicit;s("id",e.id)}}function Xt(i,l){if(i&1&&d(0,Jt,1,1,"lab-tooltip",11),i&2){let e=a().$implicit;w(e.id?0:-1)}}function Yt(i,l){if(i&1){let e=g();c(0,"button",12),u("click",function(){f(e);let n=a().$index,o=a();return b(o.removeEntry(n))}),m()}if(i&2){let e=a().$implicit,t=a();s("disabled",e.id===t.ItemId.Module)}}function ei(i,l){if(i&1){let e=g();c(0,"div",2)(1,"lab-input-number",3),u("setValue",function(n){let o=f(e).$index,r=a();return b(r.setCount(o,n))}),m(),c(2,"p-dropdown",4),h(3,"filterOptions"),u("onChange",function(n){let o=f(e).$index,r=a();return b(r.setId(o,n))}),d(4,Kt,3,4,"ng-template",5)(5,Gt,7,6,"ng-template",6),m(),d(6,Xt,1,1,"ng-template",null,0,E)(8,Yt,1,1,"button",7),m()}if(i&2){let e,t=l.$implicit,n=l.$index,o=M(7),r=a();p(),s("value",(e=t.count)!==null&&e!==void 0?e:r.rational.zero)("maximum",r.maximum()[n])("disabled",t.id===r.ItemId.Module),p(),s("ngModel",t.id)("pTooltip",o)("options",We(3,7,r.options(),r.exclude(),t.id)),p(6),w(r.entity().modules!==!0?8:-1)}}var he=(()=>{class i{constructor(){this.recipeSvc=D(st),this.settingsSvc=D(ae),this.entity=Q.required(),this.modules=Q.required(),this.recipeId=Q(),this.setValue=Le(),this.data=this.settingsSvc.dataset,this.exclude=J(()=>this.modules().map(e=>e.id).filter(oe)),this.sum=J(()=>this.modules().map(e=>e.count).filter(oe).reduce((e,t)=>e.add(t),C.zero)),this.options=J(()=>this.recipeSvc.moduleOptions(this.entity(),this.data(),this.recipeId())),this.maximum=J(()=>{let e=this.modules(),t=V(this.entity().modules,C.zero);if(t===!0)return e.map(()=>null);let n=this.sum(),o=e.find(_=>_.id===$.Module);o&&(n=n.sub(V(o.count,C.zero)));let r=t.sub(n);return e.map(_=>V(_.count,C.zero).add(r))}),this.rational=C,this.ItemId=$}setCount(e,t){let n=this.modules().map((o,r)=>e===r?F(o,{count:t}):o);this.updateEmpty(n),this.setValue.emit(n)}setId(e,t){t.originalEvent.stopPropagation();let n=t.value,o=this.modules().map((r,_)=>e===_?F(r,{id:n}):r);this.setValue.emit(o)}removeEntry(e){let t=this.modules().filter((n,o)=>e!==o);this.updateEmpty(t),this.setValue.emit(t)}updateEmpty(e){let t=this.entity().modules;if(t===!0||t==null)return;let n=e.map(o=>o.count).filter(oe).reduce((o,r)=>o.add(r),C.zero);if(n.lt(t)){let o=t.sub(n),r=e.find(_=>_.id===$.Module);r?r.count=V(r.count,C.zero).add(o):e.push({id:$.Module,count:o})}else if(n.gt(t)){let o=n.sub(t),r=e.find(_=>_.id===$.Module);r&&(r.count=V(r.count,C.zero).sub(o),r.count.isZero()&&e.splice(e.indexOf(r),1))}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=O({type:i,selectors:[["lab-modules"]],inputs:{entity:[1,"entity"],modules:[1,"modules"],recipeId:[1,"recipeId"]},outputs:{setValue:"setValue"},standalone:!0,features:[q],decls:3,vars:0,consts:[["tooltip",""],[1,"d-flex","flex-column"],[1,"p-inputgroup"],["width","3rem",3,"setValue","value","maximum","disabled"],["labDropdownBase","icon",3,"onChange","ngModel","pTooltip","options"],["pTemplate","selectedItem"],["pTemplate","item"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"disabled"],[1,"d-flex"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","module",3,"id"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"click","disabled"]],template:function(t,n){t&1&&(c(0,"div",1),te(1,ei,9,11,"div",2,Ut),m()),t&2&&(p(),ie(n.modules()))},dependencies:[pe,le,se,W,j,z,ce,K,R,U,ve,mt,ue,me,be],encapsulation:2,changeDetection:0})}}return i})();function ii(i,l){if(i&1){let e=g();c(0,"lab-input-number",10),h(1,"translate"),u("setValue",function(n){f(e);let o=a().$index,r=a();return b(r.setTotal(o,n))}),m()}if(i&2){let e=a().$implicit;s("pTooltip",y(1,2,"beaconsOverlay.totalTooltip"))("value",e.total)}}function ni(i,l){if(i&1&&(c(0,"div",4),v(1,"i"),h(2,"iconSmClass"),m()),i&2){let e=l.$implicit;p(),T(y(2,2,e.value))}}function oi(i,l){if(i&1&&v(0,"lab-tooltip",19),i&2){let e=a().$implicit;s("id",e.value)}}function ri(i,l){if(i&1&&(c(0,"div",17),v(1,"i"),h(2,"iconSmClass"),c(3,"div",18),B(4),m(),d(5,oi,1,1,"ng-template",null,0,E),m()),i&2){let e=l.$implicit,t=M(6);s("pTooltip",t),p(),T(y(2,4,e.value)),p(3),ne(" ",e.label," ")}}function ai(i,l){if(i&1&&v(0,"lab-tooltip",19),i&2){let e=a(2).$implicit;s("id",e.id)}}function li(i,l){if(i&1&&d(0,ai,1,1,"lab-tooltip",19),i&2){let e=a().$implicit;w(e.id?0:-1)}}function si(i,l){if(i&1){let e=g();c(0,"lab-modules",20),u("setValue",function(n){f(e);let o=a().$index,r=a();return b(r.setModules(o,n))}),m()}if(i&2){let e=a().$implicit,t=a();s("entity",t.data().beaconEntities[e.id])("modules",e.modules)("recipeId",t.recipeId())}}function pi(i,l){if(i&1){let e=g();c(0,"div",3)(1,"div",9)(2,"lab-input-number",10),h(3,"translate"),u("setValue",function(n){let o=f(e).$index,r=a();return b(r.setCount(o,n))}),m(),d(4,ii,2,4,"lab-input-number",11),c(5,"p-dropdown",12),u("onChange",function(n){let o=f(e).$index,r=a();return b(r.setId(o,n))}),d(6,ni,3,4,"ng-template",13)(7,ri,7,6,"ng-template",14),m(),d(8,li,1,1,"ng-template",null,0,E),c(10,"button",15),u("click",function(){let n=f(e).$index,o=a();return b(o.removeEntry(n))}),m()(),d(11,si,1,3,"lab-modules",16),m()}if(i&2){let e,t=l.$implicit,n=M(9),o=a();p(2),s("pTooltip",y(3,8,"beaconsOverlay.eachTooltip"))("value",(e=t.count)!==null&&e!==void 0?e:o.rational.zero),p(2),w(t.total?4:-1),p(),s("ngModel",t.id)("pTooltip",n)("options",o.options().beacons),p(5),s("disabled",o.beacons().length===1),p(),w(t.id&&t.modules?11:-1)}}var On=(()=>{class i extends fe{constructor(){super(...arguments),this.settingsSvc=D(ae),this.setValue=new N,this.data=this.settingsSvc.dataset,this.options=this.settingsSvc.options,this.beacons=I([]),this.recipeId=I(void 0),this.rational=C}show(e,t,n){this.beacons.set(t.map(o=>F(o,{modules:o.modules?.map(r=>F(r))}))),this.recipeId.set(n),this._show(e)}setCount(e,t){this.beacons.update(n=>(n[e].count=t,n))}setId(e,t){t.originalEvent.stopPropagation(),this.beacons.update(n=>(n[e].id=t.value,n))}setModules(e,t){this.beacons.update(n=>(n[e].modules=t,n))}setTotal(e,t){this.beacons.update(n=>(n[e].total=t,n))}removeEntry(e){this.beacons.update(t=>t.filter((n,o)=>o!==e))}addEntry(){this.beacons.update(e=>{let t=this.options().beacons[0].value,n=this.data().beaconEntities[t].modules,o=[{id:$.Module,count:n}];return e.push({id:t,count:C.zero,modules:o}),e})}save(){let e=this.beacons().map(t=>F(t,{modules:t.modules?.filter(n=>n.count?.nonzero())}));this.setValue.emit(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Y(i)))(n||i)}})()}static{this.\u0275cmp=O({type:i,selectors:[["lab-beacons-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[ee,q],decls:12,vars:9,consts:[["tooltip",""],["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","flex-column"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-plus",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],[1,"p-inputgroup"],["width","3rem","tooltipPosition","top",3,"setValue","pTooltip","value"],["width","3rem","tooltipPosition","top",3,"pTooltip","value"],["labDropdownBase","icon",3,"onChange","ngModel","pTooltip","options"],["pTemplate","selectedItem"],["pTemplate","item"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"click","disabled"],[3,"entity","modules","recipeId"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","beacon",3,"id"],[3,"setValue","entity","modules","recipeId"]],template:function(t,n){t&1&&(c(0,"p-overlayPanel",1),u("onHide",function(){return n.onHide()}),c(1,"div",2),te(2,pi,12,10,"div",3,Ae),c(4,"div",4)(5,"button",5),h(6,"translate"),u("click",function(){return n.addEntry()}),m()(),c(7,"div",6)(8,"button",7),h(9,"translate"),u("click",function(){return n.hide()}),m(),c(10,"button",8),h(11,"translate"),u("click",function(){return n.hide(!0)}),m()()()()),t&2&&(p(2),ie(n.beacons()),p(3),s("label",y(6,3,"beaconsOverlay.addBeacons")),p(3),s("label",y(9,5,"ok")),p(2),s("label",y(11,7,"cancel")))},dependencies:[pe,le,se,W,j,z,ce,K,_e,de,R,U,ve,ue,me,he,be,re],encapsulation:2,changeDetection:0})}}return i})();function ci(i,l){if(i&1){let e=g();c(0,"lab-modules",6),u("setValue",function(n){f(e);let o=a();return b(o.modules.set(n))}),m()}if(i&2){let e=a();s("entity",l)("modules",e.modules())("recipeId",e.recipeId())}}var Wn=(()=>{class i extends fe{constructor(){super(...arguments),this.setValue=new N,this.machine=I(void 0),this.modules=I([]),this.recipeId=I(void 0)}show(e,t,n,o){this.machine.set(n),this.modules.set(t.map(r=>F(r))),this.recipeId.set(o),this._show(e)}save(){let e=this.modules();this.machine()?.modules!==!0&&(e=e.filter(t=>t.count?.nonzero())),this.setValue.emit(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Y(i)))(n||i)}})()}static{this.\u0275cmp=O({type:i,selectors:[["lab-modules-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[ee,q],decls:8,vars:7,consts:[["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[3,"entity","modules","recipeId"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],[3,"setValue","entity","modules","recipeId"]],template:function(t,n){if(t&1&&(c(0,"p-overlayPanel",0),u("onHide",function(){return n.onHide()}),c(1,"div",1),d(2,ci,1,3,"lab-modules",2),c(3,"div",3)(4,"button",4),h(5,"translate"),u("click",function(){return n.hide()}),m(),c(6,"button",5),h(7,"translate"),u("click",function(){return n.hide(!0)}),m()()()()),t&2){let o;p(2),w((o=n.machine())?2:-1,o),p(2),s("label",y(5,3,"ok")),p(2),s("label",y(7,5,"cancel"))}},dependencies:[W,j,_e,de,he,re],encapsulation:2,changeDetection:0})}}return i})();export{Li as a,Pi as b,Ri as c,Ni as d,ve as e,mt as f,On as g,Wn as h};
